<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Docker基础篇Docker基本介绍Docker解决了运行环境和配置问题的软件容器，方便做持续集成并有助于整体发布的容器虚拟技术。 docker容器化和传统虚拟化对比 传统虚拟机技术是虚拟出一套硬件后，在其上运行一个完整操作系统，在该系统上再运行所需应用进程。 容器内的应用进程直接运行于宿主的内核，容器内没有自己的内核且也没有进行硬件虚拟。因此容器要比传统虚拟机更为轻便。*每个容器之间互相隔离，">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker使用教程">
<meta property="og:url" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/index.html">
<meta property="og:site_name" content="没有尾巴的小驴">
<meta property="og:description" content="Docker基础篇Docker基本介绍Docker解决了运行环境和配置问题的软件容器，方便做持续集成并有助于整体发布的容器虚拟技术。 docker容器化和传统虚拟化对比 传统虚拟机技术是虚拟出一套硬件后，在其上运行一个完整操作系统，在该系统上再运行所需应用进程。 容器内的应用进程直接运行于宿主的内核，容器内没有自己的内核且也没有进行硬件虚拟。因此容器要比传统虚拟机更为轻便。*每个容器之间互相隔离，">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622142848269.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622142907345.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220621181539906.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220621182125160.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220621182241707.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622094904086.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622095037663.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622100027763.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622100113162.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622102147678.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622102353147-16558646643081.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622102414661.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622102900855.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622103231661.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622103423334.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622103504497.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622114804529.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622115612005.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622144545749.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622145231276.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622145222067.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622150146445.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622150339012.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622150534532.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622151218586.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622152031378.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622152615286.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622153946472.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622153933056.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622162019848.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622154543537.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623094731402.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623095826314.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623100250504.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623101530550.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623101854378.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623141459135.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623141532564.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623141545896.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623162050428.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623142830258.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623142934352.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623142954534.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623155008096.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623161634802.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623162714071.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623165208845.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623170509381.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623171742118.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220624100656244.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220624103403718.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220627095325539.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220627095939639.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220627111117577.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220627111438172.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220627111610118.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220627164506870.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220628093423850.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220628095026065.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220628100905707.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220628101916323.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220629163518774.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220629164930814.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220629162011529.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220629173933458.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220629175126838.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220629180733287.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630104753829.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630104821932.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630105232958.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630150303693.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630160228259.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630165709733.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630165656846.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630170538145.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630171553535.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630171926150.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630172951742.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630173615810.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630174449331.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220701181552555.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220704101501756.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220704174639188.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220704173956963.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220704174522811.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220707154229709.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220707154256117.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711095513161.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711095936163.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711095634071.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711104142725.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711104500407.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711104959058.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711105450756.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711105614326.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711111942091.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711111957285.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711112409042.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711113738622.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711143129996.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711143206345.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711144651535.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711145214878.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711145331236.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711160351344.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713112919136.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713114123302.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713114355095.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713142752158.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713143350616.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713144539019.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713150837019.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713151026003.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713151304263.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713151739282.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713152004887.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713152036034.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713151924027.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713152107657.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713152346715.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714103527732.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714103736071.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714103814901.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714143442534.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714145350189.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714150320354.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714150216530.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714150703563.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714150825232.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714151221472.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714151332696.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714150038196.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714152105425.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714152223290.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714152455077.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714152622137.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714153343688.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714153444556.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714153516596.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714153602936.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714153624929.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714153646538.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714153813686.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714153837217.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714154225907.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714154256756.png">
<meta property="og:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714154310424.png">
<meta property="article:published_time" content="2022-06-21T08:22:09.000Z">
<meta property="article:modified_time" content="2025-06-25T08:08:45.239Z">
<meta property="article:author" content="Rui Zhang">
<meta property="article:tag" content="Docker">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622142848269.png">

<link rel="canonical" href="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>Docker使用教程 | 没有尾巴的小驴</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">没有尾巴的小驴</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">记录生活</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">22</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类<span class="badge">22</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">52</span></a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.jpg">
      <meta itemprop="name" content="Rui Zhang">
      <meta itemprop="description" content="不在沉默中爆发，就在沉默中灭亡">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="没有尾巴的小驴">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Docker使用教程
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-21 16:22:09" itemprop="dateCreated datePublished" datetime="2022-06-21T16:22:09+08:00">2022-06-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-06-25 16:08:45" itemprop="dateModified" datetime="2025-06-25T16:08:45+08:00">2025-06-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Docker/" itemprop="url" rel="index"><span itemprop="name">Docker</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>45k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>41 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Docker基础篇"><a href="#Docker基础篇" class="headerlink" title="Docker基础篇"></a>Docker基础篇</h1><h2 id="Docker基本介绍"><a href="#Docker基本介绍" class="headerlink" title="Docker基本介绍"></a>Docker基本介绍</h2><p>Docker解决了运行环境和配置问题的软件容器，方便做持续集成并有助于整体发布的容器虚拟技术。</p>
<h3 id="docker容器化和传统虚拟化对比"><a href="#docker容器化和传统虚拟化对比" class="headerlink" title="docker容器化和传统虚拟化对比"></a>docker容器化和传统虚拟化对比</h3><ol>
<li>传统虚拟机技术是虚拟出一套硬件后，在其上运行一个完整操作系统，在该系统上再运行所需应用进程。</li>
<li>容器内的应用进程直接运行于宿主的内核，容器内没有自己的内核且也没有进行硬件虚拟。因此容器要比传统虚拟机更为轻便。*每个容器之间互相隔离，每个容器有自己的文件系统，容器之间进程不会相互影响，能区分计算资源。</li>
</ol>
<h3 id="为什么docker比VM虚拟机快"><a href="#为什么docker比VM虚拟机快" class="headerlink" title="为什么docker比VM虚拟机快?"></a><strong>为什么docker比VM虚拟机快?</strong></h3><ol>
<li><p>docker有着比虚拟机更少的抽象层</p>
<p>由于docker不需要Hypervisor(虚拟机)实现硬件资源虚拟化,运行在docker容器上的程序直接使用的都是实际物理机的硬件资源。因此在CPU、内存利用率上docker将会在效率上有明显优势。</p>
</li>
<li><p>docker利用的是宿主机的内核,而不需要加载操作系统OS内核</p>
<p>当新建一个容器时 ,docker不需要和虚拟机一样重新加载一个操作系统内核。进而避免引寻、加载操作系统内核返回等比较费时费资源的过程,当新建一个虚拟机时,虚拟机软件需要加载OS,返回新建过程是分钟级别的。而docker由于直接利用宿主机的操作系统,则省略了返回过程,因此新建一个docker容器只需要几秒钟。</p>
</li>
</ol>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622142848269.png" alt="image-20220622142848269" style="zoom:80%;">

<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622142907345.png" alt="image-20220622142907345" style="zoom:80%;">





<h3 id="官网与仓库"><a href="#官网与仓库" class="headerlink" title="官网与仓库"></a>官网与仓库</h3><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220621181539906.png" alt="image-20220621181539906" style="zoom:80%;">

<p><strong>docker hub：</strong>docker 安装镜像的仓库</p>
<h3 id="安装所需环境"><a href="#安装所需环境" class="headerlink" title="安装所需环境"></a>安装所需环境</h3><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220621182125160.png" alt="image-20220621182125160"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220621182241707.png" alt="image-20220621182241707"></p>
<h3 id="基本组成"><a href="#基本组成" class="headerlink" title="基本组成"></a>基本组成</h3><p>镜像、容器、仓库 三要素 ，仓库存储镜像，容器是镜像的实例。</p>
<h4 id="镜像"><a href="#镜像" class="headerlink" title="镜像"></a>镜像</h4><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622094904086.png" alt="image-20220622094904086"></p>
<h4 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h4><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622095037663.png" alt="image-20220622095037663"></p>
<h4 id="仓库"><a href="#仓库" class="headerlink" title="仓库"></a>仓库</h4><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622100027763.png" alt="image-20220622100027763"></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622100113162.png" alt="image-20220622100113162"></p>
<h2 id="Docker架构与工作原理"><a href="#Docker架构与工作原理" class="headerlink" title="Docker架构与工作原理"></a>Docker架构与工作原理</h2><h3 id="入门版"><a href="#入门版" class="headerlink" title="入门版"></a>入门版</h3><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622102147678.png" alt="image-20220622102147678"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622102353147-16558646643081.png" alt="image-20220622102353147"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622102414661.png" alt="image-20220622102414661"></p>
<h3 id="架构版"><a href="#架构版" class="headerlink" title="架构版"></a>架构版</h3><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622102900855.png" alt="image-20220622102900855"></p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622103231661.png" alt="image-20220622103231661" style="zoom:80%;">

<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622103423334.png" alt="image-20220622103423334" style="zoom:80%;">

<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622103504497.png" alt="image-20220622103504497" style="zoom:80%;">

<h2 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h2><p>参考官网：<a href="https://docs.docker.com/engine/install/centos/" target="_blank" rel="noopener">https://docs.docker.com/engine/install/centos/</a></p>
<ol>
<li><p>确保Centos7以上版本</p>
</li>
<li><p>卸载旧版本</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo yum remove docker \</span><br><span class="line">                 docker-client \</span><br><span class="line">                 docker-client-latest \</span><br><span class="line">                 docker-common \</span><br><span class="line">                 docker-latest \</span><br><span class="line">                 docker-latest-logrotate \</span><br><span class="line">                 docker-logrotate \</span><br><span class="line">                 docker-engine</span><br></pre></td></tr></table></figure>
</li>
<li><p>yum安装gcc相关依赖</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo yum -y install gcc</span><br><span class="line">sudo yum -y install gcc-c++</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装需要的软件包</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils</span><br><span class="line"><span class="meta"> #</span><span class="bash"><span class="comment"># 不建议使用原生国外仓库</span></span></span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">   --add-repo \</span><br><span class="line">   https://download.docker.com/linux/centos/docker-ce.repo </span><br><span class="line"><span class="meta"> #</span><span class="bash"><span class="comment"># 建议使用阿里云仓库</span></span></span><br><span class="line">sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新yum 软件包索引</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum makecache fast</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装docker引擎</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install docker-ce docker-ce-cli containerd.io docker-compose-plugin</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动docker</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start docker</span><br><span class="line">sudo docker run hello-world</span><br><span class="line">docker version</span><br></pre></td></tr></table></figure>
</li>
<li><p>卸载</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop docker</span><br><span class="line">sudo yum remove docker-ce docker-ce-cli containerd.io docker-compose-plugin</span><br><span class="line">sudo rm -rf /var/lib/docker</span><br><span class="line">sudo rm -rf /var/lib/containerd</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="阿里云镜像加速"><a href="#阿里云镜像加速" class="headerlink" title="阿里云镜像加速"></a>阿里云镜像加速</h2><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622114804529.png" alt="image-20220622114804529"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /etc/docker</span><br><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-'EOF'</span><br><span class="line">&#123;</span><br><span class="line">  "registry-mirrors": ["https://g2mvwk3a.mirror.aliyuncs.com"]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>

<h2 id="Docker-run-流程图"><a href="#Docker-run-流程图" class="headerlink" title="Docker run 流程图"></a>Docker run 流程图</h2><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622115612005.png" alt="image-20220622115612005"></p>
<h2 id="Docker常用命令"><a href="#Docker常用命令" class="headerlink" title="Docker常用命令"></a>Docker常用命令</h2><h3 id="帮助启动类命令"><a href="#帮助启动类命令" class="headerlink" title="帮助启动类命令"></a>帮助启动类命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">启动docker: systemctl start docker</span><br><span class="line">停止docker: systemctl stop docker</span><br><span class="line">重启docker: systemctl restart docker</span><br><span class="line">查看docker状态: systemctl status docker</span><br><span class="line">开机启动: systemctl enable docker</span><br><span class="line">查看docker概要信息: docker info</span><br><span class="line">查看容器状态信息：docker stats</span><br><span class="line">查看docker总体帮助文档: docker --help</span><br><span class="line">查看docker命令帮助文档: docker 具体命令--help</span><br></pre></td></tr></table></figure>

<h3 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h3><h4 id="docker-images"><a href="#docker-images" class="headerlink" title="docker images"></a>docker images</h4><p>列出本地主机上的镜像</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622144545749.png" alt="image-20220622144545749"></p>
<p><strong>OPTIONS说明：</strong></p>
<p>​        -a：列出本地所有的镜像（含历史映像层）</p>
<p>​        -q:   只显示镜像ID</p>
<h4 id="docker-search-OPTIONS-镜像名称"><a href="#docker-search-OPTIONS-镜像名称" class="headerlink" title="docker search [OPTIONS]  镜像名称"></a>docker search [OPTIONS]  镜像名称</h4><p>查找镜像：<a href="https://hub.docker.com" target="_blank" rel="noopener">https://hub.docker.com</a></p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622145231276.png" alt="image-20220622145231276" style="zoom:80%;">

<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622145222067.png" alt="image-20220622145222067"></p>
<p><strong>OPTIONS说明：</strong></p>
<p>–limit：只列出N个镜像，默认25个</p>
<h4 id="docker-pull-镜像名称-TAG"><a href="#docker-pull-镜像名称-TAG" class="headerlink" title="docker pull 镜像名称[:TAG]"></a>docker pull 镜像名称[:TAG]</h4><p>下载镜像：没有TAG就是最新版等价于 docker pull 镜像名字:latest</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622150146445.png" alt="image-20220622150146445"></p>
<h4 id="docker-system-df"><a href="#docker-system-df" class="headerlink" title="docker system df"></a>docker system df</h4><p>查询镜像/容器/数据卷所占的空间</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622150339012.png" alt="image-20220622150339012"></p>
<h4 id="docker-rmi-镜像ID"><a href="#docker-rmi-镜像ID" class="headerlink" title="docker rmi 镜像ID"></a>docker rmi 镜像ID</h4><p>删除镜像</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622150534532.png" alt="image-20220622150534532"></p>
<p>删除单个：docker rmi -f 镜像ID</p>
<p>删除多个：docker rmi -f 镜像ID1 镜像ID2  或者  docker rmi -f 镜像名1:TAG 镜像名2:TAG</p>
<p>删除全部：docker rmi -f ${docker images -qa}</p>
<h4 id="docker的虚悬镜像是什么？"><a href="#docker的虚悬镜像是什么？" class="headerlink" title="docker的虚悬镜像是什么？"></a>docker的虚悬镜像是什么？</h4><p> 仓库名、标签都是<none>的镜像，俗称虚悬镜像dangling image</none></p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622151218586.png" alt="image-20220622151218586" style="zoom:80%;">

<h3 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h3><h4 id="docker-run-OPTIONS-镜像ID-镜像名-COMMAND-ARG…"><a href="#docker-run-OPTIONS-镜像ID-镜像名-COMMAND-ARG…" class="headerlink" title="docker run [OPTIONS]  镜像ID/镜像名  [COMMAND] [ARG…]"></a>docker run [OPTIONS]  镜像ID/镜像名  [COMMAND] [ARG…]</h4><p>新建+启动容器</p>
<h5 id="OPTIONS说明"><a href="#OPTIONS说明" class="headerlink" title="OPTIONS说明"></a>OPTIONS说明</h5><p>​        <img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622152031378.png" alt="image-20220622152031378" style="zoom:80%;"></p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622152615286.png" alt="image-20220622152615286" style="zoom:80%;">

<h5 id="启动交互式容器（前台命令行）"><a href="#启动交互式容器（前台命令行）" class="headerlink" title="启动交互式容器（前台命令行）"></a>启动交互式容器（前台命令行）</h5><ul>
<li>docker run -it ubuntu bash</li>
</ul>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622153946472.png" alt="image-20220622153946472"></p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622153933056.png" alt="image-20220622153933056" style="zoom: 80%;">

<p>运行进去容器，退出退出，容器停止</p>
<p>运行进去容器，ctrl+p+q退出，容器不停止</p>
<h5 id="启动守护式容器（后台服务器）"><a href="#启动守护式容器（后台服务器）" class="headerlink" title="启动守护式容器（后台服务器）"></a>启动守护式容器（后台服务器）</h5><p>在大部分的场景下，我们希望docker的服务是在后台运行的,我们可以过-d指定容器的后台运行模式。</p>
<ul>
<li>docker run -d 容器名</li>
</ul>
<p>​    <img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622162019848.png" alt="image-20220622162019848" style="zoom:80%;"></p>
<p>一般为了避免上述情况，让centos后台运行则使用</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd centos bash</span><br></pre></td></tr></table></figure>



<h4 id="docker-ps-OPTIONS"><a href="#docker-ps-OPTIONS" class="headerlink" title="docker ps [OPTIONS]"></a>docker ps [OPTIONS]</h4><p>列出当前所有正在运行的容器</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220622154543537.png" alt="image-20220622154543537"></p>
<p><strong>OPTIONS说明：</strong></p>
<p>​        -a：列出当前所有正在运行的容器+历史上运行过的</p>
<p>​        -l:   显示最近创建的容器</p>
<p>​        -n：显示最近n个创建的容器</p>
<p>​        -q：静默模式，只显示容器编号</p>
<h4 id="docker-start-容器ID-容器名"><a href="#docker-start-容器ID-容器名" class="headerlink" title="docker start 容器ID/容器名"></a>docker start 容器ID/容器名</h4><p>启动已停止的容器</p>
<h4 id="docker-restart-容器ID-容器名"><a href="#docker-restart-容器ID-容器名" class="headerlink" title="docker restart  容器ID/容器名"></a>docker restart  容器ID/容器名</h4><p>重启容器</p>
<h4 id="docker-stop-容器ID-容器名"><a href="#docker-stop-容器ID-容器名" class="headerlink" title="docker stop  容器ID/容器名"></a>docker stop  容器ID/容器名</h4><p>停止容器</p>
<h4 id="docker-kill-容器ID-容器名"><a href="#docker-kill-容器ID-容器名" class="headerlink" title="docker kill  容器ID/容器名"></a>docker kill  容器ID/容器名</h4><p>强制停止容器</p>
<h4 id="docker-rm-容器ID-容器名"><a href="#docker-rm-容器ID-容器名" class="headerlink" title="docker rm 容器ID/容器名"></a>docker rm 容器ID/容器名</h4><p>删除已经停止的容器</p>
<p><strong>OPTIONS说明：</strong></p>
<p>​        -f：强制删除正在运行的容器</p>
<p><strong>一次性删除多个容器实例</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker rm -f $(docker ps -a -q)</span><br><span class="line">docker ps -a -q / xargs docker rm</span><br></pre></td></tr></table></figure>

<h4 id="docker-logs-容器ID-容器名"><a href="#docker-logs-容器ID-容器名" class="headerlink" title="docker logs 容器ID/容器名"></a>docker logs 容器ID/容器名</h4><p>查看容器运行日志</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623094731402.png" alt="image-20220623094731402"></p>
<h4 id="docker-top-容器ID-容器名"><a href="#docker-top-容器ID-容器名" class="headerlink" title="docker top 容器ID/容器名"></a>docker top 容器ID/容器名</h4><p>查看容器负载情况</p>
<h4 id="docker-inspect-容器ID-容器名"><a href="#docker-inspect-容器ID-容器名" class="headerlink" title="docker inspect  容器ID/容器名"></a>docker inspect  容器ID/容器名</h4><p>查看容器内部细节</p>
<h4 id="进入正在运行的容器并以命令行交互"><a href="#进入正在运行的容器并以命令行交互" class="headerlink" title="进入正在运行的容器并以命令行交互"></a>进入正在运行的容器并以命令行交互</h4><h5 id="docker-exec-it-容器ID-bash"><a href="#docker-exec-it-容器ID-bash" class="headerlink" title="docker exec -it 容器ID bash"></a>docker exec -it 容器ID bash</h5><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623095826314.png" alt="image-20220623095826314"></p>
<h5 id="docker-attach-容器ID"><a href="#docker-attach-容器ID" class="headerlink" title="docker attach 容器ID"></a>docker attach 容器ID</h5><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623100250504.png" alt="image-20220623100250504"></p>
<h5 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h5><p>attach 直接进入容器启动命令的终端，不会启动新的进程，用exit退出，会导致容器的停止。</p>
<p>exec是在容器中打开新的终端，并且可以启动新的进程，用exit退出，不会导致容器的停止。</p>
<p>推荐使用docker exec 命令</p>
<h4 id="docker-cp-容器ID-容器内路径-目的主机路径"><a href="#docker-cp-容器ID-容器内路径-目的主机路径" class="headerlink" title="docker cp 容器ID:容器内路径 目的主机路径"></a>docker cp 容器ID:容器内路径 目的主机路径</h4><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623101530550.png" alt="image-20220623101530550"></p>
<h4 id="导入和导出容器"><a href="#导入和导出容器" class="headerlink" title="导入和导出容器"></a>导入和导出容器</h4><h5 id="docker-export-容器ID-gt-文件名-tar-gz"><a href="#docker-export-容器ID-gt-文件名-tar-gz" class="headerlink" title="docker export 容器ID &gt; 文件名.tar.gz"></a>docker export 容器ID &gt; 文件名.tar.gz</h5><p>export导出容器的内容作为一个tar归档文件[对应import命令]</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623101854378.png" alt="image-20220623101854378"></p>
<h5 id="cat-文件名-tzg-gz-docker-impot-镜像用户-镜像名-镜像版本号"><a href="#cat-文件名-tzg-gz-docker-impot-镜像用户-镜像名-镜像版本号" class="headerlink" title="cat 文件名.tzg.gz | docker impot - 镜像用户/镜像名:镜像版本号"></a>cat 文件名.tzg.gz | docker impot - 镜像用户/镜像名:镜像版本号</h5><p>import 从tar包中的内容创建一新的文件系统再导入为镜像[对应export]</p>
<h3 id="小总结"><a href="#小总结" class="headerlink" title="小总结"></a>小总结</h3><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623141459135.png" alt="image-20220623141459135"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623141532564.png" alt="image-20220623141532564"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623141545896.png" alt="image-20220623141545896"></p>
<h2 id="Docker镜像"><a href="#Docker镜像" class="headerlink" title="Docker镜像"></a>Docker镜像</h2><p>是一种轻量级、可执行的独立软件包，它包含运行某个软件所需的所有内容，我们把应用程序和配置依赖打包好形成一个可交付的运行环境(包括代码、运行时需要的库、环境变量和配置文件等)，这个打包好的运行环境就是image镜像文件。只有通过这个镜像文件才能生成Docker容器实例(类似Java中new出来一个对象)。</p>
<h3 id="分层的镜像"><a href="#分层的镜像" class="headerlink" title="分层的镜像"></a>分层的镜像</h3><p>我们可以发现镜像的下载是分层的，好处是：</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623162050428.png" alt="image-20220623162050428"></p>
<h3 id="联合文件系统"><a href="#联合文件系统" class="headerlink" title="联合文件系统"></a>联合文件系统</h3><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623142830258.png" alt="image-20220623142830258"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623142934352.png" alt="image-20220623142934352"></p>
<h3 id="镜像加载原理"><a href="#镜像加载原理" class="headerlink" title="镜像加载原理"></a>镜像加载原理</h3><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623142954534.png" alt="image-20220623142954534"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623155008096.png" alt="image-20220623155008096"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623161634802.png" alt="image-20220623161634802"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623162714071.png" alt="image-20220623162714071"></p>
<h3 id="docker-commit"><a href="#docker-commit" class="headerlink" title="docker commit"></a>docker commit</h3><p>提交容器副本使之成为一个新的镜像</p>
<p>docker commit   -m=”提交的描述信息”   -a=”作者”  容器ID 要创建的目标镜像名:[标签名]</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623165208845.png" alt="image-20220623165208845"></p>
<p><strong>总结</strong>：</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623170509381.png" alt="image-20220623170509381"></p>
<h3 id="本地镜像发布阿里云"><a href="#本地镜像发布阿里云" class="headerlink" title="本地镜像发布阿里云"></a>本地镜像发布阿里云</h3><p>阿里云ECS Docker生态如下图所示：</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220623171742118.png" alt="image-20220623171742118"></p>
<p>阿里云创建镜像仓库</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220624100656244.png" alt="image-20220624100656244"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 登录阿里云Docker Registry</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> docker login --username=zhangruiquan registry.cn-hangzhou.aliyuncs.com</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 从Registry中拉取镜像</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> docker pull registry.cn-hangzhou.aliyuncs.com/zruiquan/ubuntu_vim:[镜像版本号]</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 将镜像推送到Registry</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> docker login --username=zhangruiquan registry.cn-hangzhou.aliyuncs.com</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/zruiquan/ubuntu_vim:[镜像版本号]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> docker push registry.cn-hangzhou.aliyuncs.com/zruiquan/ubuntu_vim:[镜像版本号]</span></span><br></pre></td></tr></table></figure>

<h3 id="本地镜像发布本地仓库"><a href="#本地镜像发布本地仓库" class="headerlink" title="本地镜像发布本地仓库"></a>本地镜像发布本地仓库</h3><ol>
<li>下载镜像Docker Registry</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker pull registry</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>运行私有库Registry，相当于本地有个私有的Docker hub</li>
</ol>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220624103403718.png" alt="image-20220624103403718"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 运行 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认端口：5000 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 上传的镜像保存目录：/var/lib/registry</span></span><br><span class="line">docker run -d  --name registry --restart=always -v /usr/local/registry/:/var/lib/registry -p 5000:5000 registry:latest</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>演示创建一个新的镜像，ubuntu安装ifconfig命令</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker run -it ubuntu bash</span><br><span class="line">root@ab2f45208eb6:/# apt-get update</span><br><span class="line">root@ab2f45208eb6:/# apt-get install net-tools</span><br><span class="line">root@ab2f45208eb6:/# ifconfig</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>提交容器变成镜像</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker commit -m="提交的描述信息"   -a="作者"  容器ID 要创建的目标镜像名:[标签名]</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>curl验证私服有什么镜像</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# curl -XGET http://192.168.106.135:5000/v2/_catalog</span><br><span class="line">&#123;"repositories":[]&#125;</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>将新镜像修改符合私服规范的Tag</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker tag ubuntuifconfig:1.0 192.168.106.135:5000/ubuntuifconfig:1.0</span><br></pre></td></tr></table></figure>

<ol start="7">
<li>修改配置文件使之支持http</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vim /etc/docker/daemon.json </span><br><span class="line">&#123;</span><br><span class="line">  "registry-mirrors": ["https://g2mvwk3a.mirror.aliyuncs.com"],</span><br><span class="line">  "insecure-registries":["192.168.106.135:5000"]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="8">
<li>push 推送到私服库</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker push 192.168.106.135:5000/ubuntuifconfig:1.0</span><br><span class="line">The push refers to repository [192.168.106.135:5000/ubuntuifconfig]</span><br><span class="line">bab10f758e94: Pushed </span><br><span class="line">9f54eef41275: Pushed </span><br><span class="line">1.0: digest: sha256:c0f22da7b437f07b11dda0191c1a20d6b92e4fe032e8ed15de8e5baade8d4c9b size: 741</span><br></pre></td></tr></table></figure>

<ol start="9">
<li>curl再次验证私服库上有什么镜像</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# curl -XGET http://192.168.106.135:5000/v2/_catalog</span><br><span class="line">&#123;"repositories":["ubuntuifconfig"]&#125;</span><br></pre></td></tr></table></figure>

<ol start="10">
<li>pull到本地</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker pull 192.168.106.135:5000/ubuntuifconfig:1.0</span><br><span class="line">1.0: Pulling from ubuntuifconfig</span><br><span class="line">7b1a6ab2e44d: Already exists </span><br><span class="line">ebeb160700b8: Already exists </span><br><span class="line">Digest: sha256:c0f22da7b437f07b11dda0191c1a20d6b92e4fe032e8ed15de8e5baade8d4c9b</span><br><span class="line">Status: Downloaded newer image for 192.168.106.135:5000/ubuntuifconfig:1.0</span><br><span class="line">192.168.106.135:5000/ubuntuifconfig:1.0</span><br></pre></td></tr></table></figure>

<ol start="11">
<li>其他常用命令</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 更改镜像名称</span></span><br><span class="line">docker tag numax/docker-domp-centos-base:v1.0 10.8.106.101:5000/numax/docker-domp-centos-base:v1.0</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 推送镜像</span></span><br><span class="line">docker push 10.8.106.101:5000/numax/docker-domp-centos-base:v1.0</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 拉取镜像</span></span><br><span class="line">docker pull 10.8.106.101:5000/numax/docker-domp-centos-base:v1.0</span><br><span class="line">docker pull 10.8.106.101:5000/numax/docker-domp-mysql:v1.0.0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除私有仓库镜像</span></span><br><span class="line">curl --header "Accept:application/vnd.docker.distribution.manifest.v2+json" -I -XGET http://10.8.106.101:5000/v2/domp-centos-base/manifests/v1.0</span><br><span class="line"></span><br><span class="line">curl -I -XDELETE http://10.8.106.101:5000/v2/domp-centos-base/manifests/sha256:8c965c83f7184c695ab26fdf71bab152723a227f0a3641caa8f981c0cb386e39</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除私有仓库内容</span></span><br><span class="line">docker exec registry bin/registry garbage-collect /etc/docker/registry/config.yml</span><br><span class="line">docker exec registry rm -rf /var/lib/registry/docker/registry/v2/repositories/domp-centos-base</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看私有仓库镜像列表和版本信息</span></span><br><span class="line">curl http://10.8.106.101:5000/v2/_catalog</span><br><span class="line">curl -X GET http://10.8.106.101:5000/v2/domp-centos-base/tags/list</span><br></pre></td></tr></table></figure>

<h3 id="本次仓库可视化界面"><a href="#本次仓库可视化界面" class="headerlink" title="本次仓库可视化界面"></a>本次仓库可视化界面</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 向 docker hub 拉取 registry 镜像</span></span><br><span class="line">docker pull hyper/docker-registry-web</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改config.yml文件，允许可视化删除</span></span><br><span class="line">    registry:</span><br><span class="line">      # Docker registry url</span><br><span class="line">      # url: http://registry-srv:5000/v2</span><br><span class="line">      # Docker registry fqdn</span><br><span class="line">      # name: localhost:5000</span><br><span class="line">      # To allow image delete, should be false</span><br><span class="line">      readonly: false</span><br><span class="line">      auth:</span><br><span class="line">        # Disable authentication</span><br><span class="line">        enabled: false</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动，并将配置挂载到本地（先将容器内配置取出来进行配置并放到本地配置目录，然后再挂载并重新启动）        </span></span><br><span class="line">docker run -d -p 5001:8080 --name registry-web --restart=always --link registry -e registry_url=http://registry:5000/v2 -e registry_name=localhost:5000  -v /conf/registry-web-config.yml:/conf/config.yml:ro  hyper/docker-registry-web:latest</span><br></pre></td></tr></table></figure>



<h2 id="Docker-容器卷"><a href="#Docker-容器卷" class="headerlink" title="Docker 容器卷"></a>Docker 容器卷</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220627095325539.png" alt="image-20220627095325539"></p>
<p>一句话:有点类似我们Redis里面的rdb和aof文件，将docker容器内的数据保存进宿主机的磁盘中，运行一个带有容器卷存储功能的容器实例。注意使用容器卷要加上–privileged=true提供访问权限。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --privileged=true -v /宿主机绝对路径目录:/容器内目录 --name=自定义容器名 镜像名</span><br></pre></td></tr></table></figure>



<h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220627095939639.png" alt="image-20220627095939639"></p>
<h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --privileged=true -v /宿主机绝对路径目录:/容器内目录 --name=自定义容器名 镜像名</span><br><span class="line">docker run -it --privileged=true -v /tmp/host_data:/tmp/docker_data  --name=u2 ubuntu</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 因为支持读写，所以相当于</span></span></span><br><span class="line">docker run -it --privileged=true -v /tmp/host_data:/tmp/docker_data:rw  --name=u2 ubuntu</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 如果容器实例内部被限制，只能读取不能写，注意：如果此时宿主机写入内容，可以同步给容器内，容器可以读取到</span></span></span><br><span class="line">docker run -it --privileged=true -v /tmp/host_data:/tmp/docker_data:ro  --name=u2 ubuntu</span><br></pre></td></tr></table></figure>

<p>还会发现在 宿主机绝对路径目录 和 容器内目录 文件数据同步，互通有无。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect 容器ID  ## 查看容器具体信息，包括容器卷路径信息等。</span><br></pre></td></tr></table></figure>

<p>卷的集成和共享，卷中的数据也可以在父子卷和宿主之间同步与共享。</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --privileged=true --volumes -from u1 --name=u2 ubuntu</span><br></pre></td></tr></table></figure>

<h2 id="软件安装"><a href="#软件安装" class="headerlink" title="软件安装"></a>软件安装</h2><p>具体参考dockerhub官网说明  <a href="https://hub.docker.com/" target="_blank" rel="noopener">https://hub.docker.com/</a></p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220627111117577.png" alt="image-20220627111117577" style="zoom:80%;">

<h3 id="tomcat"><a href="#tomcat" class="headerlink" title="tomcat"></a>tomcat</h3><p>步骤：</p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220627111438172.png" alt="image-20220627111438172" style="zoom:80%;">



<p>命令：</p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220627111610118.png" alt="image-20220627111610118" style="zoom:80%;">

<p>注意：</p>
<p>因为默认webapp为空，所以访问8080端口显示失败</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker run -d -p 8080:8080 --name t1 tomcat</span><br><span class="line">[root@localhost ~]# docker exec -it f0d94067e4bc bash</span><br><span class="line">root@f0d94067e4bc:/usr/local/tomcat# rm -rf webapps</span><br><span class="line">root@f0d94067e4bc:/usr/local/tomcat# mv webapps.dist/ webapps</span><br><span class="line">访问：8080端口</span><br></pre></td></tr></table></figure>

<p>使用免修改版：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker pull billygoo/tomcat8-jdk8</span><br><span class="line">docker run -d -p 8080:8080 --name mytomcat8 billygoo/tomcat8-jdk8</span><br></pre></td></tr></table></figure>

<h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h3><h4 id="简单版"><a href="#简单版" class="headerlink" title="简单版"></a>简单版</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker pull mysql:5.7</span><br><span class="line">[root@localhost ~]# docker run -p 3306:3306  --name mymysql -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7</span><br><span class="line">[root@localhost ~]# docker exec -it 9eda5dffc50a bash</span><br><span class="line">root@9eda5dffc50a:/# mysql -uroot -p       </span><br><span class="line">Enter password:</span><br></pre></td></tr></table></figure>

<p><strong>注意，简单版安装会出现以下问题：</strong></p>
<p><strong>1、插入中文会报错，docker上默认字符集编码隐患</strong></p>
<p><strong>2、删除容器后，里面的mysql数据怎么办</strong></p>
<h4 id="实战版"><a href="#实战版" class="headerlink" title="实战版"></a>实战版</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 新建mysql容器实例，使用容器卷，保证删除容器后的数据持久化</span></span></span><br><span class="line">docker run -d -p 3306:3306 --privileged=true </span><br><span class="line">-v /zrq/mysql/log:/var/log/mysql </span><br><span class="line">-v /zrq/mysql/data:/var/lib/mysql </span><br><span class="line">-v /zrq/mysql/conf:/etc/mysql/conf.d </span><br><span class="line">-e MYSQL_ROOT_PASSWORD=123456 </span><br><span class="line">--name mysql mysql:5.7</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 解决中文乱码问题</span></span></span><br><span class="line">[root@localhost conf]# cd /zrq/mysql/conf/</span><br><span class="line">[root@localhost conf]# vim my.cnf</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 添加如下支持中文配置</span></span></span><br><span class="line">[client]</span><br><span class="line">default_character_set=utf8</span><br><span class="line">[mysqld]</span><br><span class="line">collation_server = utf8_general_ci</span><br><span class="line">character_set_server = utf8</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 重启mysql</span></span></span><br><span class="line">docker restart mysql</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 测试删除mysql，数据是否还在</span></span></span><br><span class="line">[root@localhost conf]# docker rm -f 6736b227d029</span><br><span class="line">[root@localhost conf]# docker run -d -p 3306:3306 --privileged=true -v /zrq/mysql/log:/var/log/mysql -v /zrq/mysql/data:/var/lib/mysql -v /zrq/mysql/conf:/etc/mysql/conf.d -e MYSQL_ROOT_PASSWORD=123456 --name mysql mysql:5.7</span><br><span class="line">a92f7c6d2a3b9953df1785f7a1394c6408dfc83ee9d4556326842706d95dfa13</span><br><span class="line">[root@localhost conf]# docker exec -it mysql bash</span><br><span class="line">root@a92f7c6d2a3b:/# mysql -uroot -p</span><br><span class="line">Enter password: </span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show databases;</span></span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| db01               |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="redis"><a href="#redis" class="headerlink" title="redis"></a>redis</h3><h4 id="简单版-1"><a href="#简单版-1" class="headerlink" title="简单版"></a>简单版</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost conf]# docker run -d -p 6379:6379 redis:6.0.8</span><br><span class="line">[root@localhost conf]# docker exec -it bdfe1f3ce105 bash</span><br><span class="line">root@bdfe1f3ce105:/data# redis-cli </span><br><span class="line">127.0.0.1:6379&gt; set k1 v1</span><br><span class="line">127.0.0.1:6379&gt; get k1</span><br></pre></td></tr></table></figure>

<h4 id="实战版-1"><a href="#实战版-1" class="headerlink" title="实战版"></a>实战版</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 在CentOS宿主机下新建目录 /zrq/redis</span></span></span><br><span class="line">[root@localhost zrq]# mkdir -p /zrq/redis</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 将一个redis.conf 文件模板拷贝到/zrq/redis目录下，准备用自己的redis配置文件</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 修改redis.conf文件</span></span></span><br><span class="line">1、开启redis验证  可选</span><br><span class="line">requirepass 123456</span><br><span class="line">2、允许redis外部连接 必须</span><br><span class="line">注释掉 # bind 127.0.0.1</span><br><span class="line">3、daemonize no </span><br><span class="line">将daemonize yes注释起来或者daemonize no设置，因为该配置和docker run中-d参数冲突，会导致容器一直启动失败</span><br><span class="line">4、开启redis数据持久化： appendonly yes 可选</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 创建redis 容器</span></span></span><br><span class="line">docker run -p 6379:6379 --name myredis --privileged=true </span><br><span class="line">-v /zrq/redis/redis.conf:/etc/redis/redis.conf </span><br><span class="line">-v /zrq/redis/data:/data </span><br><span class="line">-d redis:6.0.8 </span><br><span class="line">redis-server /etc/redis/redis.conf</span><br><span class="line">[root@localhost conf]# docker exec -it myredis bash</span><br><span class="line">root@ef9896b7ff47:/data# redis-cli </span><br><span class="line">127.0.0.1:6379&gt; set k1 v1</span><br><span class="line">127.0.0.1:6379&gt; get k1</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 测试是否用了自己的配置</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 修改/zrq/redis/redis.conf 文件</span></span></span><br><span class="line">databases 10 ## 改成10</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 重启redis</span></span></span><br><span class="line">docker restart myredis</span><br><span class="line">[root@localhost redis]# docker exec -it myredis bash</span><br><span class="line">root@ef9896b7ff47:/data# redis-cl</span><br><span class="line">i </span><br><span class="line">127.0.0.1:6379&gt; select 11</span><br><span class="line">(error) ERR DB index is out of range</span><br><span class="line">127.0.0.1:6379&gt; select 9</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<h1 id="高级篇"><a href="#高级篇" class="headerlink" title="高级篇"></a>高级篇</h1><h2 id="mysql-主从复制搭建步骤"><a href="#mysql-主从复制搭建步骤" class="headerlink" title="mysql 主从复制搭建步骤"></a>mysql 主从复制搭建步骤</h2><p> <img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220627164506870.png" alt="image-20220627164506870"></p>
<ol>
<li><p>新建主服务器容器实例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost conf]# docker run  -p 3307:3306 --name mysql-master --privileged=true </span><br><span class="line">-v /zrq/mysql-master/log:/var/log/mysql  </span><br><span class="line">-v /zrq/mysql-master/data:/var/lib/mysql  </span><br><span class="line">-v /zrq/mysql-master/conf:/etc/mysql  </span><br><span class="line">-e MYSQL_ROOT_PASSWORD=root  </span><br><span class="line">-d mysql:5.7</span><br></pre></td></tr></table></figure>
</li>
<li><p>进入/zrq/mysql-master/conf 目录下新建my.cnf</p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220628093423850.png" alt="image-20220628093423850" style="zoom:80%;">

</li>
</ol>
<p>​    修改完之后重启实例</p>
<ol start="3">
<li><p>master容器实例内创建数据同步用户</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost conf]# docker exec -it mysql-master bash</span><br><span class="line">root@8ec2d0979659:/# mysql -u root -p</span><br><span class="line">Enter password: </span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> create user <span class="string">'slave'</span>@<span class="string">'%'</span> identified by <span class="string">'123456'</span>;</span></span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> GRANT REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO <span class="string">'slave'</span>@<span class="string">'%'</span>;</span></span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>
</li>
<li><p>新建从服务器容器实例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost conf]# docker run  -p 3308:3306 --name mysql-slave --privileged=true </span><br><span class="line">-v /zrq/mysql-slave/log:/var/log/mysql  </span><br><span class="line">-v /zrq/mysql-slave/data:/var/lib/mysql  </span><br><span class="line">-v /zrq/mysql-slave/conf:/etc/mysql  </span><br><span class="line">-e MYSQL_ROOT_PASSWORD=root  </span><br><span class="line">-d mysql:5.7</span><br></pre></td></tr></table></figure>
</li>
<li><p>进入/zrq/mysql-slave/conf 目录下新建my.cnf</p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220628095026065.png" alt="image-20220628095026065" style="zoom:80%;">

</li>
</ol>
<p>​        修改完之后重启mysql-slave实例</p>
<ol start="6">
<li><p>在主数据库中查看主从同步状态</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show master status</span><br><span class="line">    -&gt; ;</span><br><span class="line">+<span class="comment">-----------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">| File                  | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span><br><span class="line">+<span class="comment">-----------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">| mall-mysql-bin.000001 |      371 |              | mysql            |                   |</span><br><span class="line">+<span class="comment">-----------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
</li>
<li><p>在从数据库中配置主从复制</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220628100905707.png" alt="image-20220628100905707"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; change master to master_host='192.168.106.135', master_user='slave',master_password='123456',master_port=3307,master_log_file='mall-mysql-bin.000003',master_log_pos=154,master_connect_retry=30;</span><br><span class="line">Query OK, 0 rows affected, 2 warnings (0.03 sec)</span><br></pre></td></tr></table></figure>
</li>
<li><p>在从数据库中查看主从同步状态</p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220628101916323.png" alt="image-20220628101916323" style="zoom:80%;">
</li>
<li><p>在从数据库中开启主从复制</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; start slave;</span><br><span class="line">Query OK, 0 rows affected (0.02 sec)</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看从数据库状态已经发现同步</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show slave status \G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">               Slave_IO_State: Waiting for master to send event</span><br><span class="line">                  Master_Host: 192.168.106.135</span><br><span class="line">                  Master_User: slave</span><br><span class="line">                  Master_Port: 3307</span><br><span class="line">                Connect_Retry: 30</span><br><span class="line">              Master_Log_File: mall-mysql-bin.000003</span><br><span class="line">          Read_Master_Log_Pos: 154</span><br><span class="line">               Relay_Log_File: mall-mysql-relay-bin.000002</span><br><span class="line">                Relay_Log_Pos: 325</span><br><span class="line">        Relay_Master_Log_File: mall-mysql-bin.000003</span><br><span class="line">             Slave_IO_Running: Yes <span class="comment">## 发现两个属性都变成了Yes</span></span><br><span class="line">            Slave_SQL_Running: Yes</span><br></pre></td></tr></table></figure>
</li>
<li><p>主从测试</p>
<p>在主库创建库表并插入数据，然后再从库查询，从而验证主从是否一致。</p>
</li>
</ol>
<h2 id="redis-cluster集群搭建步骤"><a href="#redis-cluster集群搭建步骤" class="headerlink" title="redis-cluster集群搭建步骤"></a>redis-cluster集群搭建步骤</h2><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220629163518774.png" alt="image-20220629163518774" style="zoom:80%;">

<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220629164930814.png" alt="image-20220629164930814"></p>
<h3 id="集群搭建"><a href="#集群搭建" class="headerlink" title="集群搭建"></a>集群搭建</h3><ol>
<li><p>启动6节点redis集群</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name redis-node-1 --net host --privileged=true -v /zrq/redis/share/redis-node-1:/data redis:6.0.8 --cluster-enabled yes --appendonly yes --port 6381;</span><br><span class="line">docker run -d --name redis-node-2 --net host --privileged=true -v /zrq/redis/share/redis-node-2:/data redis:6.0.8 --cluster-enabled yes --appendonly yes --port 6382;</span><br><span class="line">docker run -d --name redis-node-3 --net host --privileged=true -v /zrq/redis/share/redis-node-3:/data redis:6.0.8 --cluster-enabled yes --appendonly yes --port 6383;</span><br><span class="line">docker run -d --name redis-node-4 --net host --privileged=true -v /zrq/redis/share/redis-node-4:/data redis:6.0.8 --cluster-enabled yes --appendonly yes --port 6384;</span><br><span class="line">docker run -d --name redis-node-5 --net host --privileged=true -v /zrq/redis/share/redis-node-5:/data redis:6.0.8 --cluster-enabled yes --appendonly yes --port 6385;</span><br><span class="line">docker run -d --name redis-node-6 --net host --privileged=true -v /zrq/redis/share/redis-node-6:/data redis:6.0.8 --cluster-enabled yes --appendonly yes --port 6386;</span><br></pre></td></tr></table></figure>

<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220629162011529.png" alt="image-20220629162011529" style="zoom:80%;">
</li>
<li><p>构建主从关系</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker exec -it redis-node-1  bash</span><br><span class="line">root@localhost:/data# redis-cli --cluster create 192.168.106.135:6381 192.168.106.135:6382 192.168.106.135:6383 192.168.106.135:6384 192.168.106.135:6385 192.168.106.135:6386 --cluster-replicas 1 </span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># --cluster-replicas 表示为每个master创建一个slave节点</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Performing <span class="built_in">hash</span> slots allocation on 6 nodes...</span></span><br><span class="line">Master[0] -&gt; Slots 0 - 5460</span><br><span class="line">Master[1] -&gt; Slots 5461 - 10922</span><br><span class="line">Master[2] -&gt; Slots 10923 - 16383</span><br><span class="line">Adding replica 192.168.106.135:6385 to 192.168.106.135:6381</span><br><span class="line">Adding replica 192.168.106.135:6386 to 192.168.106.135:6382</span><br><span class="line">Adding replica 192.168.106.135:6384 to 192.168.106.135:6383</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Trying to optimize slaves allocation <span class="keyword">for</span> anti-affinity</span></span><br><span class="line">[WARNING] Some slaves are in the same host as their master</span><br><span class="line">M: ef952349810dc76a04f3fe800b5945319b41ff15 192.168.106.135:6381</span><br><span class="line">   slots:[0-5460] (5461 slots) master</span><br><span class="line">M: 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9 192.168.106.135:6382</span><br><span class="line">   slots:[5461-10922] (5462 slots) master</span><br><span class="line">M: 6727317ea63c1d6c4163bc32a3c46ddb44558485 192.168.106.135:6383</span><br><span class="line">   slots:[10923-16383] (5461 slots) master</span><br><span class="line">S: d09193ed5d6f8a621dae3d4e99da01d145f8efd8 192.168.106.135:6384</span><br><span class="line">   replicates 6727317ea63c1d6c4163bc32a3c46ddb44558485</span><br><span class="line">S: 8fa90ae66688e950a319052c17e10c2ef2f6aaa6 192.168.106.135:6385</span><br><span class="line">   replicates ef952349810dc76a04f3fe800b5945319b41ff15</span><br><span class="line">S: 47cef94998f7d6a6d9878b5b37b3adfa47eacc5b 192.168.106.135:6386</span><br><span class="line">   replicates 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9</span><br><span class="line">   Can I set the above configuration? (type 'yes' to accept): yes</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Nodes configuration updated</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Assign a different config epoch to each node</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Sending CLUSTER MEET messages to join the cluster</span></span><br><span class="line">Waiting for the cluster to join</span><br><span class="line">.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Performing Cluster Check (using node 192.168.106.135:6381)</span></span><br><span class="line">M: ef952349810dc76a04f3fe800b5945319b41ff15 192.168.106.135:6381</span><br><span class="line">   slots:[0-5460] (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: d09193ed5d6f8a621dae3d4e99da01d145f8efd8 192.168.106.135:6384</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6727317ea63c1d6c4163bc32a3c46ddb44558485</span><br><span class="line">S: 8fa90ae66688e950a319052c17e10c2ef2f6aaa6 192.168.106.135:6385</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates ef952349810dc76a04f3fe800b5945319b41ff15</span><br><span class="line">M: 6727317ea63c1d6c4163bc32a3c46ddb44558485 192.168.106.135:6383</span><br><span class="line">   slots:[10923-16383] (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">M: 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9 192.168.106.135:6382</span><br><span class="line">   slots:[5461-10922] (5462 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: 47cef94998f7d6a6d9878b5b37b3adfa47eacc5b 192.168.106.135:6386</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check <span class="keyword">for</span> open slots...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check slots coverage...</span></span><br><span class="line">[OK] All 16384 slots covered.</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看节点状态以及挂载关系</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 查看节点状态信息</span></span></span><br><span class="line">root@localhost:/data# redis-cli -p 6381</span><br><span class="line">127.0.0.1:6381&gt; cluster info</span><br><span class="line">cluster_state:ok</span><br><span class="line">cluster_slots_assigned:16384</span><br><span class="line">cluster_slots_ok:16384</span><br><span class="line">cluster_slots_pfail:0</span><br><span class="line">cluster_slots_fail:0</span><br><span class="line">cluster_known_nodes:6</span><br><span class="line">cluster_size:3</span><br><span class="line">cluster_current_epoch:6</span><br><span class="line">cluster_my_epoch:1</span><br><span class="line">cluster_stats_messages_ping_sent:105</span><br><span class="line">cluster_stats_messages_pong_sent:105</span><br><span class="line">cluster_stats_messages_sent:210</span><br><span class="line">cluster_stats_messages_ping_received:100</span><br><span class="line">cluster_stats_messages_pong_received:105</span><br><span class="line">cluster_stats_messages_meet_received:5</span><br><span class="line">cluster_stats_messages_received:210</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 查看集群节点状态信息</span></span></span><br><span class="line">127.0.0.1:6381&gt; cluster nodes</span><br><span class="line">d09193ed5d6f8a621dae3d4e99da01d145f8efd8 192.168.106.135:6384@16384 slave 6727317ea63c1d6c4163bc32a3c46ddb44558485 0 1656491461000 3 connected</span><br><span class="line">8fa90ae66688e950a319052c17e10c2ef2f6aaa6 192.168.106.135:6385@16385 slave ef952349810dc76a04f3fe800b5945319b41ff15 0 1656491459000 1 connected</span><br><span class="line">6727317ea63c1d6c4163bc32a3c46ddb44558485 192.168.106.135:6383@16383 master - 0 1656491462336 3 connected 10923-16383</span><br><span class="line">6ee8d6d52eb307656ce5fc5e8fd538477fd109a9 192.168.106.135:6382@16382 master - 0 1656491461000 2 connected 5461-10922</span><br><span class="line">ef952349810dc76a04f3fe800b5945319b41ff15 192.168.106.135:6381@16381 myself,master - 0 1656491460000 1 connected 0-5460</span><br><span class="line">47cef94998f7d6a6d9878b5b37b3adfa47eacc5b 192.168.106.135:6386@16386 slave 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9 0 1656491461319 2 connected</span><br></pre></td></tr></table></figure>
</li>
<li><p>连接集群</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@localhost:/data# redis-cli -p 6381 -c</span><br><span class="line">127.0.0.1:6381&gt; set k1 v1</span><br><span class="line"><span class="meta">-&gt;</span><span class="bash"> Redirected to slot [12706] located at 192.168.106.135:6383</span></span><br><span class="line">OK</span><br><span class="line">192.168.106.135:6383&gt; ## 注意，这里已经跳转到6383了</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 注意连接集群环境要加上参数 -c 优化路由，如果不加，则只能存储key落在当前master节点的哈希槽的数据，否则会出现如下错误</span></span></span><br><span class="line">127.0.0.1:6381&gt; set k1 v1</span><br><span class="line">(error) MOVED 12706 192.168.106.135:6383</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询集群状态信息</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">root@localhost:/data# redis-cli --cluster check 192.168.106.135:6381</span><br><span class="line">192.168.106.135:6381 (ef952349...) -&gt; 2 keys | 5461 slots | 1 slaves.</span><br><span class="line">192.168.106.135:6383 (6727317e...) -&gt; 1 keys | 5461 slots | 1 slaves.</span><br><span class="line">192.168.106.135:6382 (6ee8d6d5...) -&gt; 1 keys | 5462 slots | 1 slaves.</span><br><span class="line">[OK] 4 keys in 3 masters.</span><br><span class="line">0.00 keys per slot on average.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Performing Cluster Check (using node 192.168.106.135:6381)</span></span><br><span class="line">M: ef952349810dc76a04f3fe800b5945319b41ff15 192.168.106.135:6381</span><br><span class="line">   slots:[0-5460] (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: d09193ed5d6f8a621dae3d4e99da01d145f8efd8 192.168.106.135:6384</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6727317ea63c1d6c4163bc32a3c46ddb44558485</span><br><span class="line">S: 8fa90ae66688e950a319052c17e10c2ef2f6aaa6 192.168.106.135:6385</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates ef952349810dc76a04f3fe800b5945319b41ff15</span><br><span class="line">M: 6727317ea63c1d6c4163bc32a3c46ddb44558485 192.168.106.135:6383</span><br><span class="line">   slots:[10923-16383] (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">M: 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9 192.168.106.135:6382</span><br><span class="line">   slots:[5461-10922] (5462 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: 47cef94998f7d6a6d9878b5b37b3adfa47eacc5b 192.168.106.135:6386</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check <span class="keyword">for</span> open slots...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check slots coverage...</span></span><br><span class="line">[OK] All 16384 slots covered.</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="集群容错"><a href="#集群容错" class="headerlink" title="集群容错"></a>集群容错</h3><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220629173933458.png" alt="image-20220629173933458"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">root@localhost:/data# redis-cli -p 6381 -c</span><br><span class="line">127.0.0.1:6381&gt; cluster nodes</span><br><span class="line">d09193ed5d6f8a621dae3d4e99da01d145f8efd8 192.168.106.135:6384@16384 slave 6727317ea63c1d6c4163bc32a3c46ddb44558485 0 1656494113048 3 connected</span><br><span class="line">8fa90ae66688e950a319052c17e10c2ef2f6aaa6 192.168.106.135:6385@16385 slave ef952349810dc76a04f3fe800b5945319b41ff15 0 1656494111010 1 connected</span><br><span class="line">6727317ea63c1d6c4163bc32a3c46ddb44558485 192.168.106.135:6383@16383 master - 0 1656494114065 3 connected 10923-16383</span><br><span class="line">6ee8d6d52eb307656ce5fc5e8fd538477fd109a9 192.168.106.135:6382@16382 master - 0 1656494112030 2 connected 5461-10922</span><br><span class="line">ef952349810dc76a04f3fe800b5945319b41ff15 192.168.106.135:6381@16381 myself,master - 0 1656494112000 1 connected 0-5460</span><br><span class="line">47cef94998f7d6a6d9878b5b37b3adfa47eacc5b 192.168.106.135:6386@16386 slave 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9 0 1656494111000 2 connected</span><br><span class="line">127.0.0.1:6381&gt; exit</span><br><span class="line">root@localhost:/data# exit</span><br><span class="line">exit</span><br><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE         COMMAND                  CREATED          STATUS          PORTS     NAMES</span><br><span class="line">06aae5b442a3   redis:6.0.8   "docker-entrypoint.s…"   57 minutes ago   Up 57 minutes             redis-node-6</span><br><span class="line">c767aa122b17   redis:6.0.8   "docker-entrypoint.s…"   57 minutes ago   Up 57 minutes             redis-node-5</span><br><span class="line">a7640bd15bf8   redis:6.0.8   "docker-entrypoint.s…"   57 minutes ago   Up 57 minutes             redis-node-4</span><br><span class="line">6310cdca0aaa   redis:6.0.8   "docker-entrypoint.s…"   57 minutes ago   Up 57 minutes             redis-node-3</span><br><span class="line">522717092d98   redis:6.0.8   "docker-entrypoint.s…"   57 minutes ago   Up 57 minutes             redis-node-2</span><br><span class="line">59edadd86f45   redis:6.0.8   "docker-entrypoint.s…"   57 minutes ago   Up 57 minutes             redis-node-1</span><br><span class="line">[root@localhost ~]# docker stop 59edadd86f45</span><br><span class="line">59edadd86f45</span><br><span class="line">[root@localhost ~]# docker exec -it redis-node-2  bash</span><br><span class="line">root@localhost:/data# redis-cli -p 6382 -c</span><br><span class="line">127.0.0.1:6382&gt; cluster nodes</span><br><span class="line">6ee8d6d52eb307656ce5fc5e8fd538477fd109a9 192.168.106.135:6382@16382 myself,master - 0 1656494197000 2 connected 5461-10922</span><br><span class="line">6727317ea63c1d6c4163bc32a3c46ddb44558485 192.168.106.135:6383@16383 master - 0 1656494196426 3 connected 10923-16383</span><br><span class="line">ef952349810dc76a04f3fe800b5945319b41ff15 192.168.106.135:6381@16381 master,fail - 1656494165925 1656494163898 1 disconnected</span><br><span class="line">47cef94998f7d6a6d9878b5b37b3adfa47eacc5b 192.168.106.135:6386@16386 slave 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9 0 1656494197445 2 connected</span><br><span class="line">d09193ed5d6f8a621dae3d4e99da01d145f8efd8 192.168.106.135:6384@16384 slave 6727317ea63c1d6c4163bc32a3c46ddb44558485 0 1656494192000 3 connected</span><br><span class="line">8fa90ae66688e950a319052c17e10c2ef2f6aaa6 192.168.106.135:6385@16385 master - 0 1656494195000 7 connected 0-5460</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 由上可知，哨兵节点将会被选举上位，作为了master节点</span></span></span><br></pre></td></tr></table></figure>

<h3 id="主从扩容"><a href="#主从扩容" class="headerlink" title="主从扩容"></a>主从扩容</h3><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220629175126838.png" alt="image-20220629175126838"></p>
<ol>
<li><p>新建两个节点并启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name redis-node-7 --net host --privileged=true -v /zrq/redis/share/redis-node-7:/data redis:6.0.8 --cluster-enabled yes --appendonly yes --port 6387;</span><br><span class="line">docker run -d --name redis-node-8 --net host --privileged=true -v /zrq/redis/share/redis-node-8:/data redis:6.0.8 --cluster-enabled yes --appendonly yes --port 6388;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将87节点（node7）加入原集群</p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220629180733287.png" alt="image-20220629180733287" style="zoom:80%;">

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 先将node7加入集群</span></span></span><br><span class="line">[root@localhost ~]# docker exec -it redis-node-7 bash</span><br><span class="line">root@localhost:/data# redis-cli --cluster add-node 192.168.106.135:6387 192.168.106.135:6381</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Adding node 192.168.106.135:6387 to cluster 192.168.106.135:6381</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Performing Cluster Check (using node 192.168.106.135:6381)</span></span><br><span class="line">M: ef952349810dc76a04f3fe800b5945319b41ff15 192.168.106.135:6381</span><br><span class="line">   slots:[0-5460] (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">M: 6727317ea63c1d6c4163bc32a3c46ddb44558485 192.168.106.135:6383</span><br><span class="line">   slots:[10923-16383] (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: 47cef94998f7d6a6d9878b5b37b3adfa47eacc5b 192.168.106.135:6386</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9</span><br><span class="line">S: 8fa90ae66688e950a319052c17e10c2ef2f6aaa6 192.168.106.135:6385</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates ef952349810dc76a04f3fe800b5945319b41ff15</span><br><span class="line">S: d09193ed5d6f8a621dae3d4e99da01d145f8efd8 192.168.106.135:6384</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6727317ea63c1d6c4163bc32a3c46ddb44558485</span><br><span class="line">M: 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9 192.168.106.135:6382</span><br><span class="line">   slots:[5461-10922] (5462 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check <span class="keyword">for</span> open slots...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check slots coverage...</span></span><br><span class="line">[OK] All 16384 slots covered.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Send CLUSTER MEET to node 192.168.106.135:6387 to make it join the cluster.</span></span><br><span class="line">[OK] New node added correctly.</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 加入集群后查看集群信息</span></span></span><br><span class="line">root@localhost:/data# redis-cli --cluster check 192.168.106.135:6381</span><br><span class="line">192.168.106.135:6381 (ef952349...) -&gt; 2 keys | 5461 slots | 1 slaves.</span><br><span class="line">192.168.106.135:6387 (2e24b667...) -&gt; 0 keys | 0 slots | 0 slaves.</span><br><span class="line">192.168.106.135:6383 (6727317e...) -&gt; 1 keys | 5461 slots | 1 slaves.</span><br><span class="line">192.168.106.135:6382 (6ee8d6d5...) -&gt; 1 keys | 5462 slots | 1 slaves.</span><br><span class="line">[OK] 4 keys in 4 masters.</span><br></pre></td></tr></table></figure>
</li>
<li><p>重新分配槽号</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker exec -it redis-node-7 bash</span><br><span class="line">root@localhost:/data# redis-cli --cluster reshard 192.168.106.135:6381</span><br></pre></td></tr></table></figure>

<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630104753829.png" alt="image-20220630104753829"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630104821932.png" alt="image-20220630104821932"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">root@localhost:/data#  redis-cli --cluster check 192.168.106.135:6381</span><br><span class="line">192.168.106.135:6381 (ef952349...) -&gt; 1 keys | 4096 slots | 1 slaves.</span><br><span class="line">192.168.106.135:6387 (2e24b667...) -&gt; 1 keys | 4096 slots | 0 slaves.</span><br><span class="line">192.168.106.135:6383 (6727317e...) -&gt; 1 keys | 4096 slots | 1 slaves.</span><br><span class="line">192.168.106.135:6382 (6ee8d6d5...) -&gt; 1 keys | 4096 slots | 1 slaves.</span><br><span class="line">[OK] 4 keys in 4 masters.</span><br><span class="line">0.00 keys per slot on average.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Performing Cluster Check (using node 192.168.106.135:6381)</span></span><br><span class="line">M: ef952349810dc76a04f3fe800b5945319b41ff15 192.168.106.135:6381</span><br><span class="line">   slots:[1365-5460] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">M: 2e24b66700e6dd93b167225e0006c82210a05647 192.168.106.135:6387</span><br><span class="line">   slots:[0-1364],[5461-6826],[10923-12287] (4096 slots) master</span><br><span class="line">M: 6727317ea63c1d6c4163bc32a3c46ddb44558485 192.168.106.135:6383</span><br><span class="line">   slots:[12288-16383] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: 47cef94998f7d6a6d9878b5b37b3adfa47eacc5b 192.168.106.135:6386</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9</span><br><span class="line">S: 8fa90ae66688e950a319052c17e10c2ef2f6aaa6 192.168.106.135:6385</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates ef952349810dc76a04f3fe800b5945319b41ff15</span><br><span class="line">S: d09193ed5d6f8a621dae3d4e99da01d145f8efd8 192.168.106.135:6384</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6727317ea63c1d6c4163bc32a3c46ddb44558485</span><br><span class="line">M: 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9 192.168.106.135:6382</span><br><span class="line">   slots:[6827-10922] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check <span class="keyword">for</span> open slots...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check slots coverage...</span></span><br><span class="line">[OK] All 16384 slots covered.</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p><strong>槽位分派说明</strong></p>
<p>​    从其他节点，切割一部分槽位分配给master4节点。</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630105232958.png" alt="image-20220630105232958"></p>
<ol start="4">
<li><p>为主节点87分配从节点88</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">root@localhost:/data# redis-cli --cluster add-node 192.168.106.135:6388  192.168.106.135:6387 --cluster-slave --cluster-master-id 2e24b66700e6dd93b167225e0006c82210a05647</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Adding node 192.168.106.135:6388 to cluster 192.168.106.135:6387</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Performing Cluster Check (using node 192.168.106.135:6387)</span></span><br><span class="line">M: 2e24b66700e6dd93b167225e0006c82210a05647 192.168.106.135:6387</span><br><span class="line">   slots:[0-1364],[5461-6826],[10923-12287] (4096 slots) master</span><br><span class="line">M: 6727317ea63c1d6c4163bc32a3c46ddb44558485 192.168.106.135:6383</span><br><span class="line">   slots:[12288-16383] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: d09193ed5d6f8a621dae3d4e99da01d145f8efd8 192.168.106.135:6384</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6727317ea63c1d6c4163bc32a3c46ddb44558485</span><br><span class="line">S: 8fa90ae66688e950a319052c17e10c2ef2f6aaa6 192.168.106.135:6385</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates ef952349810dc76a04f3fe800b5945319b41ff15</span><br><span class="line">M: ef952349810dc76a04f3fe800b5945319b41ff15 192.168.106.135:6381</span><br><span class="line">   slots:[1365-5460] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: 47cef94998f7d6a6d9878b5b37b3adfa47eacc5b 192.168.106.135:6386</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9</span><br><span class="line">M: 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9 192.168.106.135:6382</span><br><span class="line">   slots:[6827-10922] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check <span class="keyword">for</span> open slots...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check slots coverage...</span></span><br><span class="line">[OK] All 16384 slots covered.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Send CLUSTER MEET to node 192.168.106.135:6388 to make it join the cluster.</span></span><br><span class="line">Waiting for the cluster to join</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Configure node as replica of 192.168.106.135:6387.</span></span><br><span class="line">[OK] New node added correctly.</span><br></pre></td></tr></table></figure>

<p>再次查看集群节点信息</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">root@localhost:/data# redis-cli --cluster check 192.168.106.135:6381</span><br><span class="line">192.168.106.135:6381 (ef952349...) -&gt; 1 keys | 4096 slots | 1 slaves.</span><br><span class="line">192.168.106.135:6387 (2e24b667...) -&gt; 1 keys | 4096 slots | 1 slaves.</span><br><span class="line">192.168.106.135:6383 (6727317e...) -&gt; 1 keys | 4096 slots | 1 slaves.</span><br><span class="line">192.168.106.135:6382 (6ee8d6d5...) -&gt; 1 keys | 4096 slots | 1 slaves.</span><br><span class="line">[OK] 4 keys in 4 masters.</span><br><span class="line">0.00 keys per slot on average.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Performing Cluster Check (using node 192.168.106.135:6381)</span></span><br><span class="line">M: ef952349810dc76a04f3fe800b5945319b41ff15 192.168.106.135:6381</span><br><span class="line">   slots:[1365-5460] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">M: 2e24b66700e6dd93b167225e0006c82210a05647 192.168.106.135:6387</span><br><span class="line">   slots:[0-1364],[5461-6826],[10923-12287] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">M: 6727317ea63c1d6c4163bc32a3c46ddb44558485 192.168.106.135:6383</span><br><span class="line">   slots:[12288-16383] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: 47cef94998f7d6a6d9878b5b37b3adfa47eacc5b 192.168.106.135:6386</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9</span><br><span class="line">S: 8fa90ae66688e950a319052c17e10c2ef2f6aaa6 192.168.106.135:6385</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates ef952349810dc76a04f3fe800b5945319b41ff15</span><br><span class="line">S: d09193ed5d6f8a621dae3d4e99da01d145f8efd8 192.168.106.135:6384</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6727317ea63c1d6c4163bc32a3c46ddb44558485</span><br><span class="line">S: 5b1a097df7eaccb05251475f859538148e0f2145 192.168.106.135:6388</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 2e24b66700e6dd93b167225e0006c82210a05647</span><br><span class="line">M: 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9 192.168.106.135:6382</span><br><span class="line">   slots:[6827-10922] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check <span class="keyword">for</span> open slots...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check slots coverage...</span></span><br><span class="line">[OK] All 16384 slots covered.</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="主从缩容"><a href="#主从缩容" class="headerlink" title="主从缩容"></a>主从缩容</h3><p>删除6387，6388，恢复3主3从</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 先删除从节点88</span></span></span><br><span class="line">root@localhost:/data# redis-cli --cluster del-node 192.168.106.135:6388 5b1a097df7eaccb05251475f859538148e0f2145</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Removing node 5b1a097df7eaccb05251475f859538148e0f2145 from cluster 192.168.106.135:6388</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Sending CLUSTER FORGET messages to the cluster...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Sending CLUSTER RESET SOFT to the deleted node.</span></span><br><span class="line">root@localhost:/data# redis-cli --cluster check 192.168.106.135:6381</span><br><span class="line">192.168.106.135:6381 (ef952349...) -&gt; 1 keys | 4096 slots | 1 slaves.</span><br><span class="line">192.168.106.135:6387 (2e24b667...) -&gt; 1 keys | 4096 slots | 0 slaves.</span><br><span class="line">192.168.106.135:6383 (6727317e...) -&gt; 1 keys | 4096 slots | 1 slaves.</span><br><span class="line">192.168.106.135:6382 (6ee8d6d5...) -&gt; 1 keys | 4096 slots | 1 slaves.</span><br><span class="line">[OK] 4 keys in 4 masters.</span><br><span class="line">0.00 keys per slot on average.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Performing Cluster Check (using node 192.168.106.135:6381)</span></span><br><span class="line">M: ef952349810dc76a04f3fe800b5945319b41ff15 192.168.106.135:6381</span><br><span class="line">   slots:[1365-5460] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">M: 2e24b66700e6dd93b167225e0006c82210a05647 192.168.106.135:6387</span><br><span class="line">   slots:[0-1364],[5461-6826],[10923-12287] (4096 slots) master</span><br><span class="line">M: 6727317ea63c1d6c4163bc32a3c46ddb44558485 192.168.106.135:6383</span><br><span class="line">   slots:[12288-16383] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: 47cef94998f7d6a6d9878b5b37b3adfa47eacc5b 192.168.106.135:6386</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9</span><br><span class="line">S: 8fa90ae66688e950a319052c17e10c2ef2f6aaa6 192.168.106.135:6385</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates ef952349810dc76a04f3fe800b5945319b41ff15</span><br><span class="line">S: d09193ed5d6f8a621dae3d4e99da01d145f8efd8 192.168.106.135:6384</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6727317ea63c1d6c4163bc32a3c46ddb44558485</span><br><span class="line">M: 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9 192.168.106.135:6382</span><br><span class="line">   slots:[6827-10922] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 清出来的槽号从新分配</span></span></span><br><span class="line">root@localhost:/data# redis-cli --cluster reshard 192.168.106.135:6381</span><br><span class="line">How many slots do you want to move (from 1 to 16384)? 4096</span><br><span class="line">What is the receiving node ID? ef952349810dc76a04f3fe800b5945319b41ff15 ## 用6381接收空余出来的槽号</span><br><span class="line">Source node #1: 2e24b66700e6dd93b167225e0006c82210a05647 ## 删除的87节点ID</span><br><span class="line">Source node #2: done</span><br><span class="line">Do you want to proceed with the proposed reshard plan (yes/no)? yes</span><br><span class="line"></span><br><span class="line">root@localhost:/data# redis-cli --cluster check 192.168.106.135:6381</span><br><span class="line">192.168.106.135:6381 (ef952349...) -&gt; 2 keys | 8192 slots | 1 slaves. ## 接收了6387的槽位</span><br><span class="line">192.168.106.135:6387 (2e24b667...) -&gt; 0 keys | 0 slots | 0 slaves. ## 槽位已经被分配出去了</span><br><span class="line">192.168.106.135:6383 (6727317e...) -&gt; 1 keys | 4096 slots | 1 slaves.</span><br><span class="line">192.168.106.135:6382 (6ee8d6d5...) -&gt; 1 keys | 4096 slots | 1 slaves.</span><br><span class="line">[OK] 4 keys in 4 masters.</span><br><span class="line">0.00 keys per slot on average.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Performing Cluster Check (using node 192.168.106.135:6381)</span></span><br><span class="line">M: ef952349810dc76a04f3fe800b5945319b41ff15 192.168.106.135:6381</span><br><span class="line">   slots:[0-6826],[10923-12287] (8192 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">M: 2e24b66700e6dd93b167225e0006c82210a05647 192.168.106.135:6387</span><br><span class="line">   slots: (0 slots) master</span><br><span class="line">M: 6727317ea63c1d6c4163bc32a3c46ddb44558485 192.168.106.135:6383</span><br><span class="line">   slots:[12288-16383] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: 47cef94998f7d6a6d9878b5b37b3adfa47eacc5b 192.168.106.135:6386</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9</span><br><span class="line">S: 8fa90ae66688e950a319052c17e10c2ef2f6aaa6 192.168.106.135:6385</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates ef952349810dc76a04f3fe800b5945319b41ff15</span><br><span class="line">S: d09193ed5d6f8a621dae3d4e99da01d145f8efd8 192.168.106.135:6384</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6727317ea63c1d6c4163bc32a3c46ddb44558485</span><br><span class="line">M: 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9 192.168.106.135:6382</span><br><span class="line">   slots:[6827-10922] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check <span class="keyword">for</span> open slots...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check slots coverage...</span></span><br><span class="line">[OK] All 16384 slots covered.</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 再删除87</span></span></span><br><span class="line">root@localhost:/data# redis-cli --cluster del-node 192.168.106.135:6387 2e24b66700e6dd93b167225e0006c82210a05647</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Removing node 2e24b66700e6dd93b167225e0006c82210a05647 from cluster 192.168.106.135:6387</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Sending CLUSTER FORGET messages to the cluster...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Sending CLUSTER RESET SOFT to the deleted node.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 恢复成3主3从</span></span></span><br><span class="line">root@localhost:/data# redis-cli --cluster check 192.168.106.135:6381</span><br><span class="line">192.168.106.135:6381 (ef952349...) -&gt; 2 keys | 8192 slots | 1 slaves.</span><br><span class="line">192.168.106.135:6383 (6727317e...) -&gt; 1 keys | 4096 slots | 1 slaves.</span><br><span class="line">192.168.106.135:6382 (6ee8d6d5...) -&gt; 1 keys | 4096 slots | 1 slaves.</span><br><span class="line">[OK] 4 keys in 3 masters.</span><br><span class="line">0.00 keys per slot on average.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Performing Cluster Check (using node 192.168.106.135:6381)</span></span><br><span class="line">M: ef952349810dc76a04f3fe800b5945319b41ff15 192.168.106.135:6381</span><br><span class="line">   slots:[0-6826],[10923-12287] (8192 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">M: 6727317ea63c1d6c4163bc32a3c46ddb44558485 192.168.106.135:6383</span><br><span class="line">   slots:[12288-16383] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: 47cef94998f7d6a6d9878b5b37b3adfa47eacc5b 192.168.106.135:6386</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9</span><br><span class="line">S: 8fa90ae66688e950a319052c17e10c2ef2f6aaa6 192.168.106.135:6385</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates ef952349810dc76a04f3fe800b5945319b41ff15</span><br><span class="line">S: d09193ed5d6f8a621dae3d4e99da01d145f8efd8 192.168.106.135:6384</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 6727317ea63c1d6c4163bc32a3c46ddb44558485</span><br><span class="line">M: 6ee8d6d52eb307656ce5fc5e8fd538477fd109a9 192.168.106.135:6382</span><br><span class="line">   slots:[6827-10922] (4096 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check <span class="keyword">for</span> open slots...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check slots coverage...</span></span><br><span class="line">[OK] All 16384 slots covered.</span><br></pre></td></tr></table></figure>

<h2 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>Dockerfile是用来构建Docker镜像的文本文件，是由一条条构建镜像所需的指令和参数构成的脚本。</p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630150303693.png" alt="image-20220630150303693" style="zoom:80%;">

<p>构建三步骤：编写DockerFile文件 -&gt;  docker build 命令构建镜像 -&gt; docker run依镜像运行实例</p>
<h3 id="Dockerfile构建过程解析"><a href="#Dockerfile构建过程解析" class="headerlink" title="Dockerfile构建过程解析"></a>Dockerfile构建过程解析</h3><p><strong>Dockerfile内容基础知识</strong></p>
<p>1：每条保留字指令都必须为大写字母且后面要跟随至少一个参数<br>2：指令按照从上到下，顺序执行<br>3：#表示注释<br>4：每条指令都会创建一个新的镜像层并对镜像进行提交</p>
<p><strong>Docker执行Dockerfile的大致流程</strong></p>
<p>1：docker从基础镜像运行一个容器<br>2：执行一条指令并对容器作出修改<br>3：执行类似docker commit的操作提交一个新的镜像层<br>4：docker再基于刚提交的镜像运行一个新容器<br>5：执行dockerfile中的下一条指令直到所有指令都执行完成</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630160228259.png" alt="image-20220630160228259"></p>
<h3 id="小总结-1"><a href="#小总结-1" class="headerlink" title="小总结"></a>小总结</h3><ol>
<li><p>Dockerfile，需要定义一个Dockerfle，Dockerfle定义了进程需要的一切东西。Dockerfle涉及的内容包括执行代码或者是文件、环境变量、依赖包、运行时环境、动态链接库、操作系统的发行版、服务进程和内核进程(当应用进程需要和系统服务和内核进程打交道，这时需要考虑如何设计namespace的权限控制)等等;</p>
</li>
<li><p>Docker镜像，在用Dockerfile定义一个文件之后，docker build时会产生一个Docker镜像，当越行Docker镜像时会真正开始提供服务;</p>
</li>
<li><p>Docker容器，容器是直接提供服务的。</p>
</li>
</ol>
<h3 id="保留字指令"><a href="#保留字指令" class="headerlink" title="保留字指令"></a>保留字指令</h3><h4 id="FROM"><a href="#FROM" class="headerlink" title="FROM"></a>FROM</h4><p>基础镜像，当前新镜像是基于哪个镜像的，指定一个已经存在的镜像作为模板，第一条必须是from</p>
<h4 id="MAINTAINER"><a href="#MAINTAINER" class="headerlink" title="MAINTAINER"></a>MAINTAINER</h4><p>镜像维护者的姓名和邮箱地址</p>
<h4 id="RUN"><a href="#RUN" class="headerlink" title="RUN"></a>RUN</h4><p>容器构建时需要运行的命令</p>
<p>两种格式：</p>
<ol>
<li><p>shell格式 </p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630165709733.png" alt="image-20220630165709733"></p>
</li>
<li><p>exec格式</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630165656846.png" alt="image-20220630165656846"></p>
</li>
</ol>
<blockquote>
<p><strong>RUN是在 docker build时运行。</strong></p>
</blockquote>
<h4 id="EXPOSE"><a href="#EXPOSE" class="headerlink" title="EXPOSE"></a>EXPOSE</h4><p>当前容器对外暴露出的端口</p>
<h4 id="WORKDIR"><a href="#WORKDIR" class="headerlink" title="WORKDIR"></a>WORKDIR</h4><p>指定在创建容器后，终端默认登陆的进来工作目录，一个落脚点</p>
<h4 id="USER"><a href="#USER" class="headerlink" title="USER"></a>USER</h4><p>指定该镜像以什么样的用户去执行，如果都不指定，默认是root</p>
<h4 id="ENV"><a href="#ENV" class="headerlink" title="ENV"></a>ENV</h4><p>用来在构建镜像过程中设置环境变量</p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630170538145.png" alt="image-20220630170538145" style="zoom:80%;">

<h4 id="ADD"><a href="#ADD" class="headerlink" title="ADD"></a>ADD</h4><p>将宿主机目录下的文件拷贝进镜像且会自动处理URL和解压tar压缩包</p>
<h4 id="COPY"><a href="#COPY" class="headerlink" title="COPY"></a>COPY</h4><p>类似ADD，拷贝文件和目录到镜像中。</p>
<p>将从构建上下文目录中&lt;源路径&gt;的文件/目录复制到新的一层的镜像内的&lt;目标路径&gt;位置</p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630171553535.png" alt="image-20220630171553535" style="zoom:80%;">

<h4 id="VOLUME"><a href="#VOLUME" class="headerlink" title="VOLUME"></a>VOLUME</h4><p>容量数据卷，用户数据保存和持久化工作。相当于 -v</p>
<h4 id="CMD"><a href="#CMD" class="headerlink" title="CMD"></a>CMD</h4><p>指定容器启动后要做的事情</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630171926150.png" alt="image-20220630171926150"></p>
<p>Dockerfile中可以有多个CMD指令，<strong>但只有最后一个生效，CMD会被docker run之后的参数替换</strong></p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630172951742.png" alt="image-20220630172951742" style="zoom:80%;">

<p><strong>它与RUN命令的区别</strong></p>
<p>CMD是在docker run时运行。</p>
<p>RUN是在docker build时运行。</p>
<h4 id="ENTRYPOINT"><a href="#ENTRYPOINT" class="headerlink" title="ENTRYPOINT"></a>ENTRYPOINT</h4><p>也是用来指定一个容器启动时要运行的命令，类似于CMD指令，但是ENTRYPOINT不会被docker run后面的命令覆盖，而且这些命令行参数会被当作参数送给ENTRYPOINT指令指定的程序。</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630173615810.png" alt="image-20220630173615810"></p>
<h4 id="小总结-2"><a href="#小总结-2" class="headerlink" title="小总结"></a>小总结</h4><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220630174449331.png" alt="image-20220630174449331" style="zoom:80%;">

<h3 id="案例-1"><a href="#案例-1" class="headerlink" title="案例"></a>案例</h3><h4 id="自定义镜像"><a href="#自定义镜像" class="headerlink" title="自定义镜像"></a>自定义镜像</h4><p>要求centos7镜像具备vim+ifconfig+jdk8</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 上传、创建所需文件</span></span></span><br><span class="line">[root@localhost myfile]# pwd</span><br><span class="line">/myfile</span><br><span class="line">[root@localhost myfile]# ll</span><br><span class="line">总用量 141544</span><br><span class="line">-rw-r--r--. 1 root root       735 7月   1 10:23 Dockerfile</span><br><span class="line">-rw-r--r--. 1 root root 144935989 7月   1 10:05 jdk-8u291-linux-x64.tar.gz</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Dockerfile文件内容如下</span></span></span><br><span class="line">FROM centos</span><br><span class="line">MAINTAINER zrq&lt;zrquan93@163.com&gt;</span><br><span class="line"></span><br><span class="line">ENV MYPATH /usr/local</span><br><span class="line">WORKDIR $MYPATH</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">安装vim编辑器</span></span><br><span class="line">RUN yum -y install vim</span><br><span class="line"><span class="meta">#</span><span class="bash">安装ifconfig命令查看网络IP</span></span><br><span class="line">RUN yum -y install net-tools</span><br><span class="line"><span class="meta">#</span><span class="bash">安装java8及lib库</span></span><br><span class="line">RUN yum -y install glibc.i686</span><br><span class="line">RUN mkdir /usr/local/java</span><br><span class="line"><span class="meta">#</span><span class="bash">ADD是相对路径jar,把jdk-8u291-linux-x64.tar.gz添加到容器中,安装包必须要和Dockerfile文件在同一位置</span></span><br><span class="line">ADD jdk-8u291-linux-x64.tar.gz /usr/local/java/</span><br><span class="line"><span class="meta">#</span><span class="bash">配置java环境变量</span></span><br><span class="line">ENV JAVA_HOME /usr/local/java/jdk1.8.0_291</span><br><span class="line">ENV JRE_HOME $JAVA_HOME/jre</span><br><span class="line">ENV CLASSPATH $JAVA_HONE/lib/dt.jar:$JAVA_HONE/lib/tools.jar:$JRE_HOME/lib:$CLASSPATH</span><br><span class="line">ENV PATH $JAVA_HOME/bin:$PATH</span><br><span class="line">EXPOSE 80</span><br><span class="line">CMD echo $MYPATH</span><br><span class="line">CMD echo "success------------------ok"</span><br><span class="line">CMD /bin/bash</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 在当前路径下打包</span></span></span><br><span class="line">[root@localhost myfile]# docker build -t centosjava8:1.5 .   ## 这里 . 代表当前目录/myfile</span><br></pre></td></tr></table></figure>

<h4 id="虚悬镜像"><a href="#虚悬镜像" class="headerlink" title="虚悬镜像"></a>虚悬镜像</h4><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220701181552555.png" alt="image-20220701181552555"></p>
<p><strong>列出所有虚悬镜像：</strong></p>
<p><code>docker image ls  -f dangling=true</code></p>
<p><strong>删除所有虚悬镜像：</strong></p>
<p><code>docker image prune</code></p>
<h4 id="docker-build-t-新镜像名字-TAG"><a href="#docker-build-t-新镜像名字-TAG" class="headerlink" title="docker build -t 新镜像名字:TAG ."></a>docker build -t 新镜像名字:TAG .</h4><p>通过Dockerfile构建镜像，这里的  .  代表与Dockerfile同目录。</p>
<h2 id="Docker-微服务实战"><a href="#Docker-微服务实战" class="headerlink" title="Docker 微服务实战"></a>Docker 微服务实战</h2><p><strong>编写Dockerfile内容</strong></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220704101501756.png" alt="image-20220704101501756"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 基础镜像使用java</span></span></span><br><span class="line">FROM java:8</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 作者</span></span></span><br><span class="line">MAINTAINER zrq</span><br><span class="line"><span class="meta">#</span><span class="bash">VOLUNE指定临时文件目录为/tmp，在主机/var/lib/docker目录下创建了一个临时文件并链接到容器的/tmp</span></span><br><span class="line">VOLUME /tmp</span><br><span class="line"><span class="meta">#</span><span class="bash">将jar包添加到容器中并更名为zrq_docker.jar</span></span><br><span class="line">ADD docker_boot-0.0.1-SNAPSHOT.jar zrq_docker.jar</span><br><span class="line"><span class="meta">#</span><span class="bash">运行jar包</span></span><br><span class="line">ENTRYPOINT [ "java" ,"- jar", "/zrq_docker. jar"]#暴露6001端口作为微服务</span><br><span class="line">EXPOSE 6001</span><br></pre></td></tr></table></figure>



<p>将微服务jar包和Dockerfile文件上传到同一个目录下/mydocker</p>
<p><strong>打包成新的镜像</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t zrq_docker:1.6 .</span><br></pre></td></tr></table></figure>

<p><strong>运行容器</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 6001:6001 镜像ID</span><br></pre></td></tr></table></figure>

<h2 id="Docker-network"><a href="#Docker-network" class="headerlink" title="Docker network"></a>Docker network</h2><h3 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h3><p>docker启动后，会产生一个名为docker0的虚拟网桥</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# ifconfig</span><br><span class="line">docker0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255</span><br><span class="line">        inet6 fe80::42:fcff:feb9:368b  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 02:42:fc:b9:36:8b  txqueuelen 0  (Ethernet)</span><br><span class="line">        RX packets 70528  bytes 3491730 (3.3 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 95632  bytes 319988557 (305.1 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">ens33: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.106.135  netmask 255.255.255.0  broadcast 192.168.106.255</span><br><span class="line">        inet6 fe80::577:7b7b:d1bf:51f4  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:0c:29:d8:02:cc  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 1810148  bytes 2130306912 (1.9 GiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 415780  bytes 163242613 (155.6 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1  (Local Loopback)</span><br><span class="line">        RX packets 4040839  bytes 5141946510 (4.7 GiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 4040839  bytes 5141946510 (4.7 GiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 当我们安装Docker后，默认会自动创建三个网格</span></span></span><br><span class="line">[root@localhost ~]# docker network ls</span><br><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">95e97de075c4   bridge    bridge    local</span><br><span class="line">72805043ac72   host      host      local</span><br><span class="line">6bd1030c092e   none      null      local</span><br></pre></td></tr></table></figure>

<p><strong>常用命令</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker network --help</span><br><span class="line">Usage:  docker network COMMAND</span><br><span class="line">Manage networks</span><br><span class="line">Commands:</span><br><span class="line">  connect     Connect a container to a network</span><br><span class="line">  create      Create a network</span><br><span class="line">  disconnect  Disconnect a container from a network</span><br><span class="line">  inspect     Display detailed information on one or more networks</span><br><span class="line">  ls          List networks</span><br><span class="line">  prune       Remove all unused networks</span><br><span class="line">  rm          Remove one or more networks</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="meta">  #</span><span class="bash">1） 常用 docker network inspect networkname 查看网络详情</span></span><br><span class="line">[root@bigdata1 docker_domp_hadoop]# docker network inspect domp_network</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        "Name": "domp_network",</span><br><span class="line">        "Id": "bc9ebce256e0d0108f5f034fa7b5b3de17f67e8bb1e964df7b01871bab196347",</span><br><span class="line">        "Created": "2023-04-26T13:05:01.324466429+08:00",</span><br><span class="line">        "Scope": "local",</span><br><span class="line">        "Driver": "bridge",</span><br><span class="line">        "EnableIPv6": false,</span><br><span class="line">        "IPAM": &#123;</span><br><span class="line">            "Driver": "default",</span><br><span class="line">            "Options": &#123;&#125;,</span><br><span class="line">            "Config": [</span><br><span class="line">                &#123;</span><br><span class="line">                    "Subnet": "172.18.0.0/16",</span><br><span class="line">                    "Gateway": "172.18.0.1"</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        "Internal": false,</span><br><span class="line">        "Attachable": false,</span><br><span class="line">        "Ingress": false,</span><br><span class="line">        "ConfigFrom": &#123;</span><br><span class="line">            "Network": ""</span><br><span class="line">        &#125;,</span><br><span class="line">        "ConfigOnly": false,</span><br><span class="line">        "Containers": &#123;</span><br><span class="line">            "46a2a14d38808edf56d7d774d1506887bd3c712994380f459a227ffc003fb0c3": &#123;</span><br><span class="line">                "Name": "bigdata2",</span><br><span class="line">                "EndpointID": "a97d992f965999651436761d7f86d35987b3451a4c1498b874868844d9dee298",</span><br><span class="line">                "MacAddress": "02:42:ac:12:00:03",</span><br><span class="line">                "IPv4Address": "172.18.0.3/16",</span><br><span class="line">                "IPv6Address": ""</span><br><span class="line">            &#125;,</span><br><span class="line">            "ad75f61dd218898a51206b091949f465189e76c9711a61f870874354398a66e9": &#123;</span><br><span class="line">                "Name": "bigdata3",</span><br><span class="line">                "EndpointID": "733cfa39033e3f07cae6c6c178b2d8d8f63b360b691dbe990ab9e3829ae26933",</span><br><span class="line">                "MacAddress": "02:42:ac:12:00:04",</span><br><span class="line">                "IPv4Address": "172.18.0.4/16",</span><br><span class="line">                "IPv6Address": ""</span><br><span class="line">            &#125;,</span><br><span class="line">            "d69e374fd77a0e129b734366aa68cd6733bffeb64dda7e62180eea63cc57076e": &#123;</span><br><span class="line">                "Name": "bigdata1",</span><br><span class="line">                "EndpointID": "2c87d6183b07cf7278fcdffd2b872faf8b2484e438966cecff6b0420ae968aa5",</span><br><span class="line">                "MacAddress": "02:42:ac:12:00:02",</span><br><span class="line">                "IPv4Address": "172.18.0.2/16",</span><br><span class="line">                "IPv6Address": ""</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        "Options": &#123;&#125;,</span><br><span class="line">        "Labels": &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"><span class="meta">#</span><span class="bash">1） 常用 docker inspect container 查看某个容器网络详情</span></span><br><span class="line">[root@bigdata1 docker_domp_hadoop]# docker inspect bigdata1 | tail -n 20</span><br><span class="line">                    "IPAMConfig": null,</span><br><span class="line">                    "Links": null,</span><br><span class="line">                    "Aliases": [</span><br><span class="line">                        "d69e374fd77a"</span><br><span class="line">                    ],</span><br><span class="line">                    "NetworkID": "bc9ebce256e0d0108f5f034fa7b5b3de17f67e8bb1e964df7b01871bab196347",</span><br><span class="line">                    "EndpointID": "2c87d6183b07cf7278fcdffd2b872faf8b2484e438966cecff6b0420ae968aa5",</span><br><span class="line">                    "Gateway": "172.18.0.1",</span><br><span class="line">                    "IPAddress": "172.18.0.2",</span><br><span class="line">                    "IPPrefixLen": 16,</span><br><span class="line">                    "IPv6Gateway": "",</span><br><span class="line">                    "GlobalIPv6Address": "",</span><br><span class="line">                    "GlobalIPv6PrefixLen": 0,</span><br><span class="line">                    "MacAddress": "02:42:ac:12:00:02",</span><br><span class="line">                    "DriverOpts": null</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="作用-1"><a href="#作用-1" class="headerlink" title="作用"></a>作用</h3><p>容器间的互联和通信以及端口映射<br>容器IP变动时候可以通过服务名直接网络通信而不受到影响</p>
<h3 id="网络模式"><a href="#网络模式" class="headerlink" title="网络模式"></a>网络模式</h3><h4 id="总体介绍"><a href="#总体介绍" class="headerlink" title="总体介绍"></a>总体介绍</h4><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220704174639188.png" alt="image-20220704174639188" style="zoom:80%;">

<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220704173956963.png" alt="image-20220704173956963" style="zoom: 67%;">
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220704174522811.png" alt="image-20220704174522811" style="zoom:67%;">



<h4 id="容器实例内默认网络IP生产规则"><a href="#容器实例内默认网络IP生产规则" class="headerlink" title="容器实例内默认网络IP生产规则"></a>容器实例内默认网络IP生产规则</h4><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220707154229709.png" alt="image-20220707154229709" style="zoom:80%;">

<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220707154256117.png" alt="image-20220707154256117" style="zoom:80%;">

<p><strong>结论：</strong></p>
<p>docker容器内部的ip是有可能会发生改变的。</p>
<h4 id="案例-2"><a href="#案例-2" class="headerlink" title="案例"></a>案例</h4><h5 id="bridge"><a href="#bridge" class="headerlink" title="bridge"></a>bridge</h5><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711095513161.png" alt="image-20220711095513161"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711095936163.png" alt="image-20220711095936163"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711095634071.png" alt="image-20220711095634071"></p>
<p><strong>测试</strong></p>
<p>启动两个tomcat程序，查看网络</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run - d - p 8081:8080 --name tomcat81 billygoo/tomcat8-jdk8</span><br><span class="line">docker run - d - p 8082:8080 --name tomcat81 billygoo/tomcat8-jdk8</span><br></pre></td></tr></table></figure>



<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711104142725.png" alt="image-20220711104142725"></p>
<h5 id="host"><a href="#host" class="headerlink" title="host"></a>host</h5><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711104500407.png" alt="image-20220711104500407"></p>
<p><strong>测试</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8083:8080 --network host --name tomcat83 billygoo/tomcat8-jdk8</span><br></pre></td></tr></table></figure>

<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711104959058.png" alt="image-20220711104959058"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect tomcat83</span><br></pre></td></tr></table></figure>

<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711105450756.png" alt="image-20220711105450756"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it tomcat83 bash</span><br></pre></td></tr></table></figure>

<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711105614326.png" alt="image-20220711105614326"></p>
<p>上图基本和宿主机网络配置一致。</p>
<h5 id="node"><a href="#node" class="headerlink" title="node"></a>node</h5><p>禁用网络功能，只有lo标识(就是127.0.0.1表示本地回环)</p>
<p><strong>测试</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p  8084:8080  --network none  --name tomcat84 billygoo/tomcat8-jdk8</span><br></pre></td></tr></table></figure>

<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711111942091.png" alt="image-20220711111942091"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711111957285.png" alt="image-20220711111957285"></p>
<h5 id="container"><a href="#container" class="headerlink" title="container"></a>container</h5><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711112409042.png" alt="image-20220711112409042"></p>
<p><strong>测试</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8085:8080 --name tomcat85 billygoo/tomcat8-jdk8</span><br><span class="line">docker run -d -p 8086:8080 --network container:tomcat85 --name tomcat86 billygoo/tomcat8-jdk8</span><br><span class="line">docker: Error response from daemon: conflicting options: port publishing and the container type network mode.See ' docker run -- help' .</span><br><span class="line"><span class="meta">#</span><span class="bash">相当于tomcat86和tomcat85公用同一个ip同一个端口，导致端口冲突本案例用tomcat演示不合适。换一个镜像给大家演示，</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Alpine操作系统是一个面向安全的轻型Linux发行版</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Alpine Linux是一款独立的、非商业的通用Linux发行版，专为追求安全性、简单性和资源效率的用户而设计。可能很多人没听说过这个Linux发行版本，但是经常用Docker的朋友可能都用过，因为他小，简单，安全而著称，所以作为基础镜像是非常好的一个选择，可谓是麻雀虽小但五脏俱全，镜像非常小巧，不到6M的大小，所以特别适合容器打包。</span></span><br><span class="line">docker run -it --name alpine1 alpine /bin/s</span><br><span class="line">docker run -it --network container:alpine1 --name alpine2 alpine /bin/sh</span><br></pre></td></tr></table></figure>

<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711113738622.png" alt="image-20220711113738622"></p>
<h5 id="自定义网络模式"><a href="#自定义网络模式" class="headerlink" title="自定义网络模式"></a>自定义网络模式</h5><h6 id="befor"><a href="#befor" class="headerlink" title="befor"></a>befor</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker run - d - p 8081:8080 --name tomcat81 billygoo/tomcat8-jdk8</span><br><span class="line">docker run - d - p 8082:8080 --name tomcat81 billygoo/tomcat8-jdk8</span><br><span class="line"><span class="meta">#</span><span class="bash"> 上述成功启动并用docker <span class="built_in">exec</span>进入各自容器实例内部</span></span><br></pre></td></tr></table></figure>

<p>按照网络</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711143129996.png" alt="image-20220711143129996"></p>
<p><strong>问题</strong></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711143206345.png" alt="image-20220711143206345"></p>
<h6 id="after"><a href="#after" class="headerlink" title="after"></a>after</h6><p>自定义桥接网络,自定义网络默认使用的是桥接网络bridge</p>
<p>新建自定义网络</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711144651535.png" alt="image-20220711144651535"></p>
<p>新建容器加入上一步新建的自定义网络</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p8081:8080 --network zzyy_network --name tomcat81 billygoo/tomcat8-jdk8</span><br><span class="line">docker run -d -p 8082:8080 --network zzyy_network --name tomcat82 billygoo/tomcat8-jdk8</span><br></pre></td></tr></table></figure>

<p>互相ping测试</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711145214878.png" alt="image-20220711145214878"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711145331236.png" alt="image-20220711145331236"></p>
<h2 id="Swarm网络"><a href="#Swarm网络" class="headerlink" title="Swarm网络"></a>Swarm网络</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 初始化Swarm</span></span><br><span class="line">docker swarm init --advertise-addr $&#123;HOST_IP1&#125;:2377 --listen-addr $&#123;HOST_IP1&#125;:2377</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入Swarm</span></span><br><span class="line">docker swarm join-token worker token</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建网络</span></span><br><span class="line">docker network create -d overlay --attachable  $&#123;NETWOEK&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 离开overlay网</span></span><br><span class="line">docker swarm leave        # 从节点 </span><br><span class="line">docker swarm leave -force # 主节点</span><br></pre></td></tr></table></figure>





<h2 id="Docker-compose容器编排"><a href="#Docker-compose容器编排" class="headerlink" title="Docker-compose容器编排"></a>Docker-compose容器编排</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>Docker-Compose是Docker官方的开源项目,负责实现对Docker容器集群的快速编排。</p>
<p>Compose是Docker公司推出的一个工具软件，可以管理多个Docker容器组成一个应用。你需要定义一个YAML格式的配置文件docker-compose.yml，写好多个容器之间的调用关系。然后，只要一个命令，就能同时启动/关闭这些容器</p>
<h3 id="作用-2"><a href="#作用-2" class="headerlink" title="作用"></a>作用</h3><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220711160351344.png" alt="image-20220711160351344"></p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>官网：<a href="https://docs.docker.com/compose/compose-file/compose-file-v3/" target="_blank" rel="noopener">https://docs.docker.com/compose/compose-file/compose-file-v3/</a></p>
<p>安装：<a href="https://docs.docker.com/compose/install/" target="_blank" rel="noopener">https://docs.docker.com/compose/install/</a></p>
<p><code>docker-compose version</code></p>
<h3 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h3><h4 id="一个文件"><a href="#一个文件" class="headerlink" title="一个文件"></a>一个文件</h4><p>docker-compose.yml</p>
<h4 id="两个要素"><a href="#两个要素" class="headerlink" title="两个要素"></a>两个要素</h4><p>服务：</p>
<p>一个个应用容器实例，比如订单微服务、库存微服务、mysql容器、nginx容器或者redis容器</p>
<p>工程：</p>
<p>由一组关联的应用容器组成的一个完整业务单元，在docker-compose.yml文件中定义。</p>
<h4 id="三个步骤"><a href="#三个步骤" class="headerlink" title="三个步骤"></a>三个步骤</h4><ol>
<li>编写Dockerfile定义各个微服务应用并构建出对应的镜像文件</li>
<li>使用docker-compose.yml<br>定义一个完整业务单元，安排好整体应用中的各个容器服务。</li>
<li>最后，执行docker-compose up命令<br>来启动并运行整个应用程序，完成一键部署上线</li>
</ol>
<h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Compose常用命令</span></span></span><br><span class="line">docker compose -h #查看帮助</span><br><span class="line">docker compose up #启动所有docker-compose服务</span><br><span class="line">docker compose up -d #启动所有docker-compose服务并后台运行</span><br><span class="line">docker compose down #停止并删除容器、网络、卷、镜像。</span><br><span class="line">docker compose exec yml 里面的服务id #进入容器实例内部 docker-compose exec docker-compose.yml文件中写的服务id /bin/bash</span><br><span class="line">docker compose ps #展示当前docker-compose编排过的运行的所有容器</span><br><span class="line">docker compose top #展示当前docker-compose编排过的容器进程</span><br><span class="line">docker compose logs yml 里面的服务id #查看容器输出日志</span><br><span class="line">dokcer compose config #检查配置</span><br><span class="line">dokcer compose config -q #检查配置，有问题才有输出docker-compose restart#重启服务</span><br><span class="line">docker compose start #启动服务</span><br><span class="line">docker compose stop #停止服务</span><br></pre></td></tr></table></figure>

<h3 id="Compose编排微服务实战"><a href="#Compose编排微服务实战" class="headerlink" title="Compose编排微服务实战"></a>Compose编排微服务实战</h3><p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713112919136.png" alt="image-20220713112919136"></p>
<h4 id="编写docker-compose-yml文件"><a href="#编写docker-compose-yml文件" class="headerlink" title="编写docker-compose.yml文件"></a>编写docker-compose.yml文件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim docker-compose.yml</span><br></pre></td></tr></table></figure>

<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713114123302.png" alt="image-20220713114123302"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713114355095.png" alt="image-20220713114355095"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 以微服务（microService）为例，此服务就相当于与单独去写</span></span><br><span class="line">docker run -d -p 6001:6001 -v /app/microService: /data--network atguigu_net --name ms01 zzyy_docker: 1.6</span><br></pre></td></tr></table></figure>

<h4 id="容器编排部署"><a href="#容器编排部署" class="headerlink" title="容器编排部署"></a>容器编排部署</h4><ol>
<li><p>将ip换成服务名<br><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713142752158.png" alt="image-20220713142752158"></p>
</li>
<li><p>打jar包并上传</p>
</li>
<li><p>编写Dockerfile</p>
<p><code>vim Dockerfile</code></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713143350616.png" alt="image-20220713143350616"></p>
<p><strong>目录构成</strong></p>
<p>/mydocker</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713144539019.png" alt="image-20220713144539019"></p>
</li>
<li><p>构建微服务新镜像</p>
<p><code>docker build -t zzyy_docker:1.6</code></p>
</li>
<li><p>开启容器编排实例,一键部署</p>
<p>在/mydocker目录下直接执行 <code>docker compose up</code> 或者<code>docker compose up -d</code></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713150837019.png" alt="image-20220713150837019"></p>
</li>
<li><p>验证</p>
<p>查看网络，由于在/mydocker目录下进行的编排，因此生成的网络名称前面加上了目录名前缀，因此redis和mysql没有指定名称的服务也自动加上此前缀。</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713151026003.png" alt="image-20220713151026003"></p>
<p>查看容器</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713151304263.png" alt="image-20220713151304263"></p>
</li>
</ol>
<p>​        建表</p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713151739282.png" alt="image-20220713151739282" style="zoom: 67%;">

<p>​        接口测试</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713152004887.png" alt="image-20220713152004887"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713152036034.png" alt="image-20220713152036034"></p>
<p>​        查看库中数据</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713151924027.png" alt="image-20220713151924027"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713152107657.png" alt="image-20220713152107657"></p>
<ol start="7">
<li><p>一键停止服务</p>
<p><code>docker compose stop</code></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220713152346715.png" alt="image-20220713152346715"></p>
</li>
</ol>
<h2 id="Docker-轻量级可视化工具Portainer"><a href="#Docker-轻量级可视化工具Portainer" class="headerlink" title="Docker 轻量级可视化工具Portainer"></a>Docker 轻量级可视化工具Portainer</h2><h3 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h3><p>Portainer是一款轻量级的应用，它提供了图形化界面，用于方便地管理Docker环境，包括单机环境和集群环境.</p>
<p>官网：</p>
<p><a href="https://www.portainer.io/" target="_blank" rel="noopener">https://www.portainer.io/</a><br><a href="https://docs.portainer.io/v/ce-2.9/start/install/server/docker/linux" target="_blank" rel="noopener">https://docs.portainer.io/v/ce-2.9/start/install/server/docker/linux</a></p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8000:8000 -p 9000:9000 --name portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># -restart=always 如果docker重启，它也会跟着自动重启，保证随时在线</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 安装完成之后访问xxx.xxx.xxx.xxx:9000端口</span></span></span><br></pre></td></tr></table></figure>

<ol>
<li>创建账号密码</li>
</ol>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714103527732.png" alt="image-20220714103527732"></p>
<ol start="2">
<li><p>选择local选项卡，展示本地docker详细信息</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714103736071.png" alt="image-20220714103736071"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714103814901.png" alt="image-20220714103814901"></p>
</li>
</ol>
<h2 id="Docker-重量器容量监控之CAdvisor-influxDB-Granfana"><a href="#Docker-重量器容量监控之CAdvisor-influxDB-Granfana" class="headerlink" title="Docker 重量器容量监控之CAdvisor + influxDB + Granfana"></a>Docker 重量器容量监控之CAdvisor + influxDB + Granfana</h2><p>通过docker stats命令可以很方便的看到当前宿主机上所有容器的CPU,内存以及网络流量等数据，一般小公司够用了。</p>
<p>但是，docker stats统计结果只能是当前宿主机的全部容器，数据资料是实时的，没有地方存储、没有健康指标过线预警等功能。</p>
<p>CAdvisor 监控收集，InfluxDB存储数据，Granfana展示图表。</p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714143442534.png" alt="image-20220714143442534" style="zoom:80%;">

<h3 id="CAdvisor"><a href="#CAdvisor" class="headerlink" title="CAdvisor"></a>CAdvisor</h3><p>CAdvisor是一个容器资源监控工具,包括容器的内存，CPU，网络IO，磁盘IO等监控，同时提供了一个WEB页面用于查看容器的实时运行状态。CAdvisor默认存储2分钟的数据,而且只是针对单物理机。不过，CAdvisor提供了很多数据集成接口，支持InfluxDB，Redis，Kafka，Elasticsearch等集成,可以加上对应配置将监控数据发往这些数据库存储起来。<br>CAdvisor功能主要有两点:</p>
<ul>
<li>展示Host和容器两个层次的监控数据。</li>
<li>展示历史变化数据。</li>
</ul>
<h3 id="InfluxDB"><a href="#InfluxDB" class="headerlink" title="InfluxDB"></a>InfluxDB</h3><p>InfluxDB是用Go语言编写的一个开源分布式时序、事件和指标数据库,无需外部依赖。CAdvisor默认只在本机保存最近2分钟的数据，为了持久化存储数据和统一收集展示监控数据，需要将数据存储到InfluxDB中。InfluxDB是一个时序数据库，专门用于存储时序相关数据，很适合存储CAdvisor的数据。而且，CAdvisor本身已经提供了InfluxDB的集成方法，启动容器时指定配置即可。<br>lnfluxDB主要功能：</p>
<ul>
<li>基于时间序列，支持与时间有关的相关函数(如最大、最小、求和等);</li>
<li>可度量性：你可以实时对大量数据进行计算;</li>
<li>基于事件：它支持任意的事件数据;</li>
</ul>
<h3 id="Granfana"><a href="#Granfana" class="headerlink" title="Granfana"></a>Granfana</h3><p>Grafana是一个开源的数据监控分析可视化平台，支持多种数据源配置(支持的数据源包括InfluxDB，MySQL，Elasticsearch，OpenTSDB，Graphite等)和丰富的插件及模板功能，支持图表权限控制和报警。<br>Grafan主要特性：</p>
<ul>
<li>灵活丰富的图形化选项。</li>
<li>可以混合多种风格。</li>
<li>支持白天和夜间模式。</li>
<li>多个数据源</li>
</ul>
<h3 id="compose容器编排一键部署"><a href="#compose容器编排一键部署" class="headerlink" title="compose容器编排一键部署"></a>compose容器编排一键部署</h3><ul>
<li><p>新建目录</p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714145350189.png" alt="image-20220714145350189"></p>
</li>
<li><p>新建三件套组合docker-compose.yml</p>
</li>
</ul>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714150320354.png" alt="image-20220714150320354"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714150216530.png" alt="image-20220714150216530"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714150703563.png" alt="image-20220714150703563"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714150825232.png" alt="image-20220714150825232"></p>
<p>检查语法是否有问题</p>
<p><code>docker compose config -q</code></p>
<ul>
<li>启动docker-compose文件，开始编排</li>
</ul>
<p><code>docker compose up</code></p>
<img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714151221472.png" alt="image-20220714151221472" style="zoom:80%;">

<ul>
<li>查看服务是否启动</li>
</ul>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714151332696.png" alt="image-20220714151332696"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714150038196.png" alt="image-20220714150038196"></p>
<ul>
<li>测试启动</li>
</ul>
<p><strong>CAdivisor 界面</strong></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714152105425.png" alt="image-20220714152105425"></p>
<p><strong>InfluxDB 界面</strong></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714152223290.png" alt="image-20220714152223290"></p>
<p><strong>Granfana 界面</strong></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714152455077.png" alt="image-20220714152455077"></p>
<ul>
<li>配置</li>
</ul>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714152622137.png" alt="image-20220714152622137"></p>
<p><strong>添加数据库</strong></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714153343688.png" alt="image-20220714153343688"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714153444556.png" alt="image-20220714153444556"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714153516596.png" alt="image-20220714153516596"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714153602936.png" alt="image-20220714153602936"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714153624929.png" alt="image-20220714153624929"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714153646538.png" alt="image-20220714153646538"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714153813686.png" alt="image-20220714153813686"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714153837217.png" alt="image-20220714153837217"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714154225907.png" alt="image-20220714154225907"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714154256756.png" alt="image-20220714154256756"></p>
<p><img src="/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/image-20220714154310424.png" alt="image-20220714154310424"></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Rui Zhang
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://yoursite.com/2022/06/21/Docker%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/" title="Docker使用教程">http://yoursite.com/2022/06/21/Docker使用教程/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Docker/" rel="tag"># Docker</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/06/10/Datahub%E5%85%83%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E6%AD%A5%E9%AA%A4/" rel="prev" title="Datahub元数据管理系统部署步骤">
      <i class="fa fa-chevron-left"></i> Datahub元数据管理系统部署步骤
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/08/08/Hadoop%E4%B9%8B%E7%94%9F%E4%BA%A7%E8%B0%83%E4%BC%98/" rel="next" title="Hadoop之生产调优">
      Hadoop之生产调优 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker基础篇"><span class="nav-number">1.</span> <span class="nav-text">Docker基础篇</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker基本介绍"><span class="nav-number">1.1.</span> <span class="nav-text">Docker基本介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#docker容器化和传统虚拟化对比"><span class="nav-number">1.1.1.</span> <span class="nav-text">docker容器化和传统虚拟化对比</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#为什么docker比VM虚拟机快"><span class="nav-number">1.1.2.</span> <span class="nav-text">为什么docker比VM虚拟机快?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#官网与仓库"><span class="nav-number">1.1.3.</span> <span class="nav-text">官网与仓库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装所需环境"><span class="nav-number">1.1.4.</span> <span class="nav-text">安装所需环境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基本组成"><span class="nav-number">1.1.5.</span> <span class="nav-text">基本组成</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#镜像"><span class="nav-number">1.1.5.1.</span> <span class="nav-text">镜像</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#容器"><span class="nav-number">1.1.5.2.</span> <span class="nav-text">容器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#仓库"><span class="nav-number">1.1.5.3.</span> <span class="nav-text">仓库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#总结"><span class="nav-number">1.1.5.4.</span> <span class="nav-text">总结</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker架构与工作原理"><span class="nav-number">1.2.</span> <span class="nav-text">Docker架构与工作原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#入门版"><span class="nav-number">1.2.1.</span> <span class="nav-text">入门版</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#架构版"><span class="nav-number">1.2.2.</span> <span class="nav-text">架构版</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装步骤"><span class="nav-number">1.3.</span> <span class="nav-text">安装步骤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#阿里云镜像加速"><span class="nav-number">1.4.</span> <span class="nav-text">阿里云镜像加速</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-run-流程图"><span class="nav-number">1.5.</span> <span class="nav-text">Docker run 流程图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker常用命令"><span class="nav-number">1.6.</span> <span class="nav-text">Docker常用命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#帮助启动类命令"><span class="nav-number">1.6.1.</span> <span class="nav-text">帮助启动类命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#镜像命令"><span class="nav-number">1.6.2.</span> <span class="nav-text">镜像命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-images"><span class="nav-number">1.6.2.1.</span> <span class="nav-text">docker images</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-search-OPTIONS-镜像名称"><span class="nav-number">1.6.2.2.</span> <span class="nav-text">docker search [OPTIONS]  镜像名称</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-pull-镜像名称-TAG"><span class="nav-number">1.6.2.3.</span> <span class="nav-text">docker pull 镜像名称[:TAG]</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-system-df"><span class="nav-number">1.6.2.4.</span> <span class="nav-text">docker system df</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-rmi-镜像ID"><span class="nav-number">1.6.2.5.</span> <span class="nav-text">docker rmi 镜像ID</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker的虚悬镜像是什么？"><span class="nav-number">1.6.2.6.</span> <span class="nav-text">docker的虚悬镜像是什么？</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#容器命令"><span class="nav-number">1.6.3.</span> <span class="nav-text">容器命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-run-OPTIONS-镜像ID-镜像名-COMMAND-ARG…"><span class="nav-number">1.6.3.1.</span> <span class="nav-text">docker run [OPTIONS]  镜像ID&#x2F;镜像名  [COMMAND] [ARG…]</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#OPTIONS说明"><span class="nav-number">1.6.3.1.1.</span> <span class="nav-text">OPTIONS说明</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#启动交互式容器（前台命令行）"><span class="nav-number">1.6.3.1.2.</span> <span class="nav-text">启动交互式容器（前台命令行）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#启动守护式容器（后台服务器）"><span class="nav-number">1.6.3.1.3.</span> <span class="nav-text">启动守护式容器（后台服务器）</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-ps-OPTIONS"><span class="nav-number">1.6.3.2.</span> <span class="nav-text">docker ps [OPTIONS]</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-start-容器ID-容器名"><span class="nav-number">1.6.3.3.</span> <span class="nav-text">docker start 容器ID&#x2F;容器名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-restart-容器ID-容器名"><span class="nav-number">1.6.3.4.</span> <span class="nav-text">docker restart  容器ID&#x2F;容器名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-stop-容器ID-容器名"><span class="nav-number">1.6.3.5.</span> <span class="nav-text">docker stop  容器ID&#x2F;容器名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-kill-容器ID-容器名"><span class="nav-number">1.6.3.6.</span> <span class="nav-text">docker kill  容器ID&#x2F;容器名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-rm-容器ID-容器名"><span class="nav-number">1.6.3.7.</span> <span class="nav-text">docker rm 容器ID&#x2F;容器名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-logs-容器ID-容器名"><span class="nav-number">1.6.3.8.</span> <span class="nav-text">docker logs 容器ID&#x2F;容器名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-top-容器ID-容器名"><span class="nav-number">1.6.3.9.</span> <span class="nav-text">docker top 容器ID&#x2F;容器名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-inspect-容器ID-容器名"><span class="nav-number">1.6.3.10.</span> <span class="nav-text">docker inspect  容器ID&#x2F;容器名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#进入正在运行的容器并以命令行交互"><span class="nav-number">1.6.3.11.</span> <span class="nav-text">进入正在运行的容器并以命令行交互</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#docker-exec-it-容器ID-bash"><span class="nav-number">1.6.3.11.1.</span> <span class="nav-text">docker exec -it 容器ID bash</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#docker-attach-容器ID"><span class="nav-number">1.6.3.11.2.</span> <span class="nav-text">docker attach 容器ID</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#区别"><span class="nav-number">1.6.3.11.3.</span> <span class="nav-text">区别</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-cp-容器ID-容器内路径-目的主机路径"><span class="nav-number">1.6.3.12.</span> <span class="nav-text">docker cp 容器ID:容器内路径 目的主机路径</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#导入和导出容器"><span class="nav-number">1.6.3.13.</span> <span class="nav-text">导入和导出容器</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#docker-export-容器ID-gt-文件名-tar-gz"><span class="nav-number">1.6.3.13.1.</span> <span class="nav-text">docker export 容器ID &gt; 文件名.tar.gz</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#cat-文件名-tzg-gz-docker-impot-镜像用户-镜像名-镜像版本号"><span class="nav-number">1.6.3.13.2.</span> <span class="nav-text">cat 文件名.tzg.gz | docker impot - 镜像用户&#x2F;镜像名:镜像版本号</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小总结"><span class="nav-number">1.6.4.</span> <span class="nav-text">小总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker镜像"><span class="nav-number">1.7.</span> <span class="nav-text">Docker镜像</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#分层的镜像"><span class="nav-number">1.7.1.</span> <span class="nav-text">分层的镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#联合文件系统"><span class="nav-number">1.7.2.</span> <span class="nav-text">联合文件系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#镜像加载原理"><span class="nav-number">1.7.3.</span> <span class="nav-text">镜像加载原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#docker-commit"><span class="nav-number">1.7.4.</span> <span class="nav-text">docker commit</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#本地镜像发布阿里云"><span class="nav-number">1.7.5.</span> <span class="nav-text">本地镜像发布阿里云</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#本地镜像发布本地仓库"><span class="nav-number">1.7.6.</span> <span class="nav-text">本地镜像发布本地仓库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#本次仓库可视化界面"><span class="nav-number">1.7.7.</span> <span class="nav-text">本次仓库可视化界面</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-容器卷"><span class="nav-number">1.8.</span> <span class="nav-text">Docker 容器卷</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简介"><span class="nav-number">1.8.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#作用"><span class="nav-number">1.8.2.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#案例"><span class="nav-number">1.8.3.</span> <span class="nav-text">案例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#软件安装"><span class="nav-number">1.9.</span> <span class="nav-text">软件安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#tomcat"><span class="nav-number">1.9.1.</span> <span class="nav-text">tomcat</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mysql"><span class="nav-number">1.9.2.</span> <span class="nav-text">mysql</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#简单版"><span class="nav-number">1.9.2.1.</span> <span class="nav-text">简单版</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#实战版"><span class="nav-number">1.9.2.2.</span> <span class="nav-text">实战版</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#redis"><span class="nav-number">1.9.3.</span> <span class="nav-text">redis</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#简单版-1"><span class="nav-number">1.9.3.1.</span> <span class="nav-text">简单版</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#实战版-1"><span class="nav-number">1.9.3.2.</span> <span class="nav-text">实战版</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#高级篇"><span class="nav-number">2.</span> <span class="nav-text">高级篇</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#mysql-主从复制搭建步骤"><span class="nav-number">2.1.</span> <span class="nav-text">mysql 主从复制搭建步骤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#redis-cluster集群搭建步骤"><span class="nav-number">2.2.</span> <span class="nav-text">redis-cluster集群搭建步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#集群搭建"><span class="nav-number">2.2.1.</span> <span class="nav-text">集群搭建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#集群容错"><span class="nav-number">2.2.2.</span> <span class="nav-text">集群容错</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#主从扩容"><span class="nav-number">2.2.3.</span> <span class="nav-text">主从扩容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#主从缩容"><span class="nav-number">2.2.4.</span> <span class="nav-text">主从缩容</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dockerfile"><span class="nav-number">2.3.</span> <span class="nav-text">Dockerfile</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概述"><span class="nav-number">2.3.1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Dockerfile构建过程解析"><span class="nav-number">2.3.2.</span> <span class="nav-text">Dockerfile构建过程解析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小总结-1"><span class="nav-number">2.3.3.</span> <span class="nav-text">小总结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#保留字指令"><span class="nav-number">2.3.4.</span> <span class="nav-text">保留字指令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#FROM"><span class="nav-number">2.3.4.1.</span> <span class="nav-text">FROM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MAINTAINER"><span class="nav-number">2.3.4.2.</span> <span class="nav-text">MAINTAINER</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RUN"><span class="nav-number">2.3.4.3.</span> <span class="nav-text">RUN</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#EXPOSE"><span class="nav-number">2.3.4.4.</span> <span class="nav-text">EXPOSE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#WORKDIR"><span class="nav-number">2.3.4.5.</span> <span class="nav-text">WORKDIR</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#USER"><span class="nav-number">2.3.4.6.</span> <span class="nav-text">USER</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ENV"><span class="nav-number">2.3.4.7.</span> <span class="nav-text">ENV</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ADD"><span class="nav-number">2.3.4.8.</span> <span class="nav-text">ADD</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#COPY"><span class="nav-number">2.3.4.9.</span> <span class="nav-text">COPY</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VOLUME"><span class="nav-number">2.3.4.10.</span> <span class="nav-text">VOLUME</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CMD"><span class="nav-number">2.3.4.11.</span> <span class="nav-text">CMD</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ENTRYPOINT"><span class="nav-number">2.3.4.12.</span> <span class="nav-text">ENTRYPOINT</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#小总结-2"><span class="nav-number">2.3.4.13.</span> <span class="nav-text">小总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#案例-1"><span class="nav-number">2.3.5.</span> <span class="nav-text">案例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#自定义镜像"><span class="nav-number">2.3.5.1.</span> <span class="nav-text">自定义镜像</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#虚悬镜像"><span class="nav-number">2.3.5.2.</span> <span class="nav-text">虚悬镜像</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-build-t-新镜像名字-TAG"><span class="nav-number">2.3.5.3.</span> <span class="nav-text">docker build -t 新镜像名字:TAG .</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-微服务实战"><span class="nav-number">2.4.</span> <span class="nav-text">Docker 微服务实战</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-network"><span class="nav-number">2.5.</span> <span class="nav-text">Docker network</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概述-1"><span class="nav-number">2.5.1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#作用-1"><span class="nav-number">2.5.2.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#网络模式"><span class="nav-number">2.5.3.</span> <span class="nav-text">网络模式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#总体介绍"><span class="nav-number">2.5.3.1.</span> <span class="nav-text">总体介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#容器实例内默认网络IP生产规则"><span class="nav-number">2.5.3.2.</span> <span class="nav-text">容器实例内默认网络IP生产规则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#案例-2"><span class="nav-number">2.5.3.3.</span> <span class="nav-text">案例</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#bridge"><span class="nav-number">2.5.3.3.1.</span> <span class="nav-text">bridge</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#host"><span class="nav-number">2.5.3.3.2.</span> <span class="nav-text">host</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#node"><span class="nav-number">2.5.3.3.3.</span> <span class="nav-text">node</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#container"><span class="nav-number">2.5.3.3.4.</span> <span class="nav-text">container</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#自定义网络模式"><span class="nav-number">2.5.3.3.5.</span> <span class="nav-text">自定义网络模式</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#befor"><span class="nav-number">2.5.3.3.5.1.</span> <span class="nav-text">befor</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#after"><span class="nav-number">2.5.3.3.5.2.</span> <span class="nav-text">after</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Swarm网络"><span class="nav-number">2.6.</span> <span class="nav-text">Swarm网络</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-compose容器编排"><span class="nav-number">2.7.</span> <span class="nav-text">Docker-compose容器编排</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概念"><span class="nav-number">2.7.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#作用-2"><span class="nav-number">2.7.2.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#下载"><span class="nav-number">2.7.3.</span> <span class="nav-text">下载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#核心概念"><span class="nav-number">2.7.4.</span> <span class="nav-text">核心概念</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#一个文件"><span class="nav-number">2.7.4.1.</span> <span class="nav-text">一个文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#两个要素"><span class="nav-number">2.7.4.2.</span> <span class="nav-text">两个要素</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#三个步骤"><span class="nav-number">2.7.4.3.</span> <span class="nav-text">三个步骤</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常用命令"><span class="nav-number">2.7.5.</span> <span class="nav-text">常用命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Compose编排微服务实战"><span class="nav-number">2.7.6.</span> <span class="nav-text">Compose编排微服务实战</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#编写docker-compose-yml文件"><span class="nav-number">2.7.6.1.</span> <span class="nav-text">编写docker-compose.yml文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#容器编排部署"><span class="nav-number">2.7.6.2.</span> <span class="nav-text">容器编排部署</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-轻量级可视化工具Portainer"><span class="nav-number">2.8.</span> <span class="nav-text">Docker 轻量级可视化工具Portainer</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简介-1"><span class="nav-number">2.8.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装"><span class="nav-number">2.8.2.</span> <span class="nav-text">安装</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-重量器容量监控之CAdvisor-influxDB-Granfana"><span class="nav-number">2.9.</span> <span class="nav-text">Docker 重量器容量监控之CAdvisor + influxDB + Granfana</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#CAdvisor"><span class="nav-number">2.9.1.</span> <span class="nav-text">CAdvisor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#InfluxDB"><span class="nav-number">2.9.2.</span> <span class="nav-text">InfluxDB</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Granfana"><span class="nav-number">2.9.3.</span> <span class="nav-text">Granfana</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#compose容器编排一键部署"><span class="nav-number">2.9.4.</span> <span class="nav-text">compose容器编排一键部署</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Rui Zhang"
      src="/images/head.jpg">
  <p class="site-author-name" itemprop="name">Rui Zhang</p>
  <div class="site-description" itemprop="description">不在沉默中爆发，就在沉默中灭亡</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">52</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 2021 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Rui Zhang</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">1.7m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">25:10</span>
</div>




        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":120,"height":230},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>
