---
title: 基于Flink的电商用户行为数据分析（1）
tags:
- Flink
categories:
- Flink
date: 2021-09-07 15:43:00
---

## 基于Flink的电商用户行为数据分析（1）



#### **主要内容**

<img src="基于Flink的电商用户行为数据分析-1/image-20210907163218315-16310035485911.png" alt="image-20210907163218315" style="zoom:67%;" />

#### **批处理和流处理**



批处理：Spark、Hadoop

流处理：Flink、Storm

批处理主要操作大容量静态数据集，并在计算过程完成后返回结果。可以认为，处理的是用一个固定时间间隔分组的数据点集合。批处理模式中使用的数据集通常符合下列特征:

* 有界：批处理数据集代表数据的有限集合
* 持久：数据通常始终存储在某种类型的持久存储位置中心
* 大量：批处理操作通常是处理极为海量数据集的唯一方法

流处理可以对随时进入系统的数据进行计算。流处理方式无需针对整个数据集执行操作，而是对通过系统传输的每个数据项执行操作。流处理中的数据集是“无边界"的，这就产生了几个重要的影响:

* 可以处理几乎无限量的数据，但同一时间只能处理一条数据，不同记录间只维持最少量的状态

* 处理工作是基于事件的，除非明确停止否则没有 “尽头”

* 处理结果立刻可用，并会随着新数据的抵达继续更新

  

#### 电商用户行为分析



![image-20210907181408398](基于Flink的电商用户行为数据分析-1/image-20210907181408398.png)



![image-20210907181420096](基于Flink的电商用户行为数据分析-1/image-20210907181420096.png)

> 用户画像：用户信息标签化



#### 项目模块设计

 

![image-20210907181350975](基于Flink的电商用户行为数据分析-1/image-20210907181350975.png)



![image-20210907181339487](基于Flink的电商用户行为数据分析-1/image-20210907181339487.png)



#### 数据源解析



<img src="基于Flink的电商用户行为数据分析-1/image-20210907181125503.png" alt="image-20210907181125503"  />





<img src="基于Flink的电商用户行为数据分析-1/image-20210907181146592.png" alt="image-20210907181146592" style="zoom:90%;" />

<img src="基于Flink的电商用户行为数据分析-1/image-20210907181252559.png" alt="image-20210907181252559" style="zoom:90%;" />



#### 项目模块



![image-20210907181804431](基于Flink的电商用户行为数据分析-1/image-20210907181804431.png)





#####  热门实时商品统计



![image-20210907182003343](基于Flink的电商用户行为数据分析-1/image-20210907182003343.png)



![image-20210907182822735](基于Flink的电商用户行为数据分析-1/image-20210907182822735.png)



###### 按照商品ID进行分区



![image-20210907185117027](基于Flink的电商用户行为数据分析-1/image-20210907185117027.png)



###### 设置时间窗口

![image-20210907185043540](基于Flink的电商用户行为数据分析-1/image-20210907185043540.png)

![image-20210907183845471](基于Flink的电商用户行为数据分析-1/image-20210907183845471.png)



###### 窗口聚合



![image-20210907185016768](基于Flink的电商用户行为数据分析-1/image-20210907185016768.png)

> 使用增量聚合函数和全窗口函数在一起的API得到输出结构，单独使用ReduceFunction 不能自定义输出结构，单独使用AggregateFunction又不能拿到window信息，因此使用结合起来的API调用形式，全窗口函数本来是拿所有数据，但这里只需要拿前面聚合的结果。

**增量聚合函数**：

![image-20210907185920519](基于Flink的电商用户行为数据分析-1/image-20210907185920519.png)

**全窗口函数**

<img src="基于Flink的电商用户行为数据分析-1/image-20210907190145538.png" alt="image-20210907190145538" style="zoom:90%;" />

![image-20210907190911254](基于Flink的电商用户行为数据分析-1/image-20210907190911254.png)



###### 统计整理



![image-20210907190932450](基于Flink的电商用户行为数据分析-1/image-20210907190932450.png)

###### 状态编程



![image-20210907191340721](基于Flink的电商用户行为数据分析-1/image-20210907191340721.png)

###### 排序输出

<img src="基于Flink的电商用户行为数据分析-1/image-20210908111834836.png" alt="image-20210908111834836" style="zoom:80%;" />

<img src="基于Flink的电商用户行为数据分析-1/image-20210908111906850.png" alt="image-20210908111906850" style="zoom:80%;" />

![image-20210908111934004](基于Flink的电商用户行为数据分析-1/image-20210908111934004.png)

##### 实时流量统计-热门页面



![image-20210908114105077](基于Flink的电商用户行为数据分析-1/image-20210908114105077.png)



##### 实时流量统计-PV-UV



![image-20210908115310855](基于Flink的电商用户行为数据分析-1/image-20210908115310855.png)

##### 市场营销分析-APP推广统计

![image-20210908115346261](基于Flink的电商用户行为数据分析-1/image-20210908115346261.png)



##### 市场营销分析-页面广告统计



![image-20210908115414325](基于Flink的电商用户行为数据分析-1/image-20210908115414325.png)



##### 恶意登陆监控

![image-20210908115428854](基于Flink的电商用户行为数据分析-1/image-20210908115428854.png)



##### 订单支付实时监控

![image-20210908115443382](基于Flink的电商用户行为数据分析-1/image-20210908115443382.png)



订单支付实施对账

![image-20210908115500342](基于Flink的电商用户行为数据分析-1/image-20210908115500342.png)











